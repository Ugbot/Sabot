<!DOCTYPE html>
<!-- Generated by Cython 3.1.4 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: marbledb.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { color: #000000; margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.cython .hll { background-color: #ffffcc }
.cython { background: #f8f8f8; }
.cython .c { color: #3D7B7B; font-style: italic } /* Comment */
.cython .err { border: 1px solid #F00 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666 } /* Operator */
.cython .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #9C6500 } /* Comment.Preproc */
.cython .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.cython .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.cython .gr { color: #E40000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #008400 } /* Generic.Inserted */
.cython .go { color: #717171 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #04D } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #687822 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #00F; font-weight: bold } /* Name.Class */
.cython .no { color: #800 } /* Name.Constant */
.cython .nd { color: #A2F } /* Name.Decorator */
.cython .ni { color: #717171; font-weight: bold } /* Name.Entity */
.cython .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.cython .nf { color: #00F } /* Name.Function */
.cython .nl { color: #767600 } /* Name.Label */
.cython .nn { color: #00F; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #A2F; font-weight: bold } /* Operator.Word */
.cython .w { color: #BBB } /* Text.Whitespace */
.cython .mb { color: #666 } /* Literal.Number.Bin */
.cython .mf { color: #666 } /* Literal.Number.Float */
.cython .mh { color: #666 } /* Literal.Number.Hex */
.cython .mi { color: #666 } /* Literal.Number.Integer */
.cython .mo { color: #666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #A45A77 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #00F } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 3.1.4</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="marbledb.cpp">marbledb.cpp</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0001</span>: <span class="c"># marbledb.pyx - Python wrapper for MarbleDB</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_test, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0002</span>: <span class="c"># cython: language_level=3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0003</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: <span class="k">from</span><span class="w"> </span><span class="nn">libcpp.string</span><span class="w"> </span><span class="k">cimport</span> <span class="n">string</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: <span class="k">from</span><span class="w"> </span><span class="nn">libcpp.memory</span><span class="w"> </span><span class="k">cimport</span> <span class="n">unique_ptr</span><span class="p">,</span> <span class="n">shared_ptr</span><span class="p">,</span> <span class="n">make_shared</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0006</span>: <span class="k">from</span><span class="w"> </span><span class="nn">libcpp.vector</span><span class="w"> </span><span class="k">cimport</span> <span class="n">vector</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0007</span>: <span class="k">from</span><span class="w"> </span><span class="nn">libcpp</span><span class="w"> </span><span class="k">cimport</span> <span class="nb">bool</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0008</span>: <span class="k">from</span><span class="w"> </span><span class="nn">cython.operator</span><span class="w"> </span><span class="k">cimport</span> <span class="n">dereference</span> <span class="k">as</span> <span class="n">deref</span><span class="p">,</span> <span class="n">preincrement</span> <span class="k">as</span> <span class="n">inc</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0009</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0010</span>: <span class="k">import</span><span class="w"> </span><span class="nn">pyarrow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pa</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_mstate_global-&gt;__pyx_n_u_pyarrow, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_pa, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0011</span>: <span class="k">cimport</span><span class="w"> </span><span class="nn">pyarrow.lib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">palib</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0012</span>: <span class="k">from</span><span class="w"> </span><span class="nn">pyarrow.lib</span><span class="w"> </span><span class="k">cimport</span> <span class="p">(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0013</span>:     <span class="n">pyarrow_wrap_schema</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0014</span>:     <span class="n">pyarrow_wrap_batch</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0015</span>:     <span class="n">pyarrow_unwrap_schema</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0016</span>:     <span class="n">pyarrow_unwrap_batch</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0017</span>: <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0018</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0019</span>: <span class="c"># Import C++ declarations</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0020</span>: <span class="k">from</span><span class="w"> </span><span class="nn">marbledb</span><span class="w"> </span><span class="k">cimport</span> <span class="p">(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0021</span>:     <span class="n">Status</span><span class="p">,</span> <span class="n">Key</span><span class="p">,</span> <span class="n">Int64Key</span><span class="p">,</span> <span class="n">TripleKey</span><span class="p">,</span> <span class="n">KeyRange</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">Record</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0022</span>:     <span class="n">QueryResult</span><span class="p">,</span> <span class="n">ColumnFamilyHandle</span><span class="p">,</span> <span class="n">ColumnFamilyOptions</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0023</span>:     <span class="n">ColumnFamilyDescriptor</span><span class="p">,</span> <span class="n">DBOptions</span><span class="p">,</span> <span class="n">WriteOptions</span><span class="p">,</span> <span class="n">ReadOptions</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0024</span>:     <span class="n">MarbleDB</span> <span class="k">as</span> <span class="n">CppMarbleDB</span><span class="p">,</span> <span class="n">TableSchema</span><span class="p">,</span> <span class="n">TableCapabilities</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0025</span>:     <span class="n">OpenDatabase</span> <span class="k">as</span> <span class="n">CppOpenDatabase</span><span class="p">,</span> <span class="n">CloseDatabase</span> <span class="k">as</span> <span class="n">CppCloseDatabase</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0026</span>:     <span class="c"># Join types and functions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0027</span>:     <span class="n">JoinType</span><span class="p">,</span> <span class="n">AsofJoinSpec</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0028</span>:     <span class="n">HashJoin</span> <span class="k">as</span> <span class="n">CppHashJoin</span><span class="p">,</span> <span class="n">AsofJoin</span> <span class="k">as</span> <span class="n">CppAsofJoin</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0029</span>: <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0030</span>: <span class="k">from</span><span class="w"> </span><span class="nn">pyarrow.includes.libarrow</span><span class="w"> </span><span class="k">cimport</span> <span class="p">(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0031</span>:     <span class="n">CSchema</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0032</span>:     <span class="n">CRecordBatch</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0033</span>:     <span class="n">CTable</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0034</span>: <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0035</span>: <span class="k">from</span><span class="w"> </span><span class="nn">pyarrow.lib</span><span class="w"> </span><span class="k">cimport</span> <span class="p">(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0036</span>:     <span class="n">pyarrow_wrap_table</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0037</span>:     <span class="n">pyarrow_unwrap_table</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0038</span>: <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0039</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0040</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0041</span>: <span class="k">class</span><span class="w"> </span><span class="nc">MarbleDBError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span></pre>
<pre class='cython code score-22 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)(((PyTypeObject*)PyExc_Exception))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = __Pyx_PEP560_update_bases(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CalculateMetaclass</span>(NULL, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = __Pyx_Py3MetaclassPrepare(__pyx_t_4, __pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError, (PyObject *) NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_kp_u_Exception_raised_for_MarbleDB_er);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_3 != __pyx_t_2) {
    if (unlikely((<span class='py_c_api'>PyDict_SetItemString</span>(__pyx_t_5, "__orig_bases__", __pyx_t_2) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 41, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_Py3ClassCreate(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError, __pyx_t_3, __pyx_t_5, NULL, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0042</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for MarbleDB errors.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0043</span>:     <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0044</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0045</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0046</span>: <span class="c"># Temporal model constants</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0047</span>: <span class="n">TEMPORAL_NONE</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_TEMPORAL_NONE, __pyx_mstate_global-&gt;__pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0048</span>: <span class="n">TEMPORAL_SYSTEM_TIME</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_TEMPORAL_SYSTEM_TIME, __pyx_mstate_global-&gt;__pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 48, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0049</span>: <span class="n">TEMPORAL_VALID_TIME</span> <span class="o">=</span> <span class="mf">2</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_TEMPORAL_VALID_TIME, __pyx_mstate_global-&gt;__pyx_int_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 49, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0050</span>: <span class="n">TEMPORAL_BITEMPORAL</span> <span class="o">=</span> <span class="mf">3</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_TEMPORAL_BITEMPORAL, __pyx_mstate_global-&gt;__pyx_int_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 50, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0052</span>: <span class="c"># GC policy constants</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0053</span>: <span class="n">GC_KEEP_ALL</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_GC_KEEP_ALL, __pyx_mstate_global-&gt;__pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0054</span>: <span class="n">GC_KEEP_RECENT</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_GC_KEEP_RECENT, __pyx_mstate_global-&gt;__pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0055</span>: <span class="n">GC_KEEP_UNTIL</span> <span class="o">=</span> <span class="mf">2</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_GC_KEEP_UNTIL, __pyx_mstate_global-&gt;__pyx_int_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 55, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0056</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0057</span>: <span class="c"># Join type constants</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0058</span>: <span class="n">JOIN_INNER</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_JOIN_INNER, __pyx_mstate_global-&gt;__pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 58, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0059</span>: <span class="n">JOIN_LEFT</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_JOIN_LEFT, __pyx_mstate_global-&gt;__pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 59, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0060</span>: <span class="n">JOIN_RIGHT</span> <span class="o">=</span> <span class="mf">2</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_JOIN_RIGHT, __pyx_mstate_global-&gt;__pyx_int_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0061</span>: <span class="n">JOIN_FULL</span> <span class="o">=</span> <span class="mf">3</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_JOIN_FULL, __pyx_mstate_global-&gt;__pyx_int_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0062</span>: <span class="n">JOIN_CROSS</span> <span class="o">=</span> <span class="mf">4</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_JOIN_CROSS, __pyx_mstate_global-&gt;__pyx_int_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 62, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0063</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0064</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0065</span>: <span class="k">cdef</span><span class="w"> </span><span class="k">class</span> <span class="nf">PyTableCapabilities</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_8marbledb_PyTableCapabilities {
  PyObject_HEAD
  marble::TableCapabilities *caps;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">0066</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Python wrapper for TableCapabilities (temporal/MVCC settings).&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0067</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">TableCapabilities</span>* <span class="nf">caps</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0068</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0069</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-14 '>/* Python wrapper */
static int __pyx_pw_8marbledb_19PyTableCapabilities_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_8marbledb_19PyTableCapabilities_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return -1;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_VARARGS</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return -1;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("__cinit__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_8marbledb_19PyTableCapabilities___cinit__(((struct __pyx_obj_8marbledb_PyTableCapabilities *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_8marbledb_19PyTableCapabilities___cinit__(struct __pyx_obj_8marbledb_PyTableCapabilities *__pyx_v_self) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0070</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">caps</span> <span class="o">=</span> <span class="n">new</span> <span class="n">TableCapabilities</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;caps = new marble::TableCapabilities();
</pre><pre class="cython line score-0">&#xA0;<span class="">0071</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0072</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__dealloc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>/* Python wrapper */
static void __pyx_pw_8marbledb_19PyTableCapabilities_3__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_8marbledb_19PyTableCapabilities_3__dealloc__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_pf_8marbledb_19PyTableCapabilities_2__dealloc__(((struct __pyx_obj_8marbledb_PyTableCapabilities *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

static void __pyx_pf_8marbledb_19PyTableCapabilities_2__dealloc__(struct __pyx_obj_8marbledb_PyTableCapabilities *__pyx_v_self) {
/* … */
  /* function exit code */
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0073</span>:         <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">caps</span></pre>
<pre class='cython code score-0 '>  delete __pyx_v_self-&gt;caps;
</pre><pre class="cython line score-0">&#xA0;<span class="">0074</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0075</span>:     <span class="nd">@property</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_19PyTableCapabilities_14temporal_model_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8marbledb_19PyTableCapabilities_14temporal_model_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_19PyTableCapabilities_14temporal_model___get__(((struct __pyx_obj_8marbledb_PyTableCapabilities *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_19PyTableCapabilities_14temporal_model___get__(struct __pyx_obj_8marbledb_PyTableCapabilities *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTableCapabilities.temporal_model.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0076</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">temporal_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0077</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get temporal model (TEMPORAL_NONE, TEMPORAL_SYSTEM_TIME, TEMPORAL_VALID_TIME, TEMPORAL_BITEMPORAL).&quot;&quot;&quot;</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0078</span>:         <span class="k">return</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">caps</span><span class="o">.</span><span class="n">temporal_model</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(((int)__pyx_v_self-&gt;caps-&gt;temporal_model));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0079</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0080</span>:     <span class="nd">@temporal_model</span><span class="o">.</span><span class="n">setter</span></pre>
<pre class='cython code score-18 '>/* Python wrapper */
static int __pyx_pw_8marbledb_19PyTableCapabilities_14temporal_model_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value); /*proto*/
static int __pyx_pw_8marbledb_19PyTableCapabilities_14temporal_model_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value) {
  int __pyx_v_value;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  assert(__pyx_arg_value); {
    __pyx_v_value = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(__pyx_arg_value); if (unlikely((__pyx_v_value == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 81, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTableCapabilities.temporal_model.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8marbledb_19PyTableCapabilities_14temporal_model_2__set__(((struct __pyx_obj_8marbledb_PyTableCapabilities *)__pyx_v_self), ((int)__pyx_v_value));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_8marbledb_19PyTableCapabilities_14temporal_model_2__set__(struct __pyx_obj_8marbledb_PyTableCapabilities *__pyx_v_self, int __pyx_v_value) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTableCapabilities.temporal_model.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0081</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">temporal_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">value</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0082</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Set temporal model.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0083</span>:         <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  switch (__pyx_v_value) {
    case 0:
/* … */
    break;
    case 1:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0084</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">caps</span><span class="o">.</span><span class="n">temporal_model</span> <span class="o">=</span> <span class="n">TableCapabilities</span><span class="o">.</span><span class="n">TemporalModel</span><span class="o">.</span><span class="n">kNone</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;caps-&gt;temporal_model = marble::TableCapabilities::TemporalModel::kNone;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0085</span>:         <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 2:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0086</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">caps</span><span class="o">.</span><span class="n">temporal_model</span> <span class="o">=</span> <span class="n">TableCapabilities</span><span class="o">.</span><span class="n">TemporalModel</span><span class="o">.</span><span class="n">kSystemTime</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;caps-&gt;temporal_model = marble::TableCapabilities::TemporalModel::kSystemTime;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0087</span>:         <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 3:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0088</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">caps</span><span class="o">.</span><span class="n">temporal_model</span> <span class="o">=</span> <span class="n">TableCapabilities</span><span class="o">.</span><span class="n">TemporalModel</span><span class="o">.</span><span class="n">kValidTime</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;caps-&gt;temporal_model = marble::TableCapabilities::TemporalModel::kValidTime;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0089</span>:         <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0090</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">caps</span><span class="o">.</span><span class="n">temporal_model</span> <span class="o">=</span> <span class="n">TableCapabilities</span><span class="o">.</span><span class="n">TemporalModel</span><span class="o">.</span><span class="n">kBitemporal</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;caps-&gt;temporal_model = marble::TableCapabilities::TemporalModel::kBitemporal;
</pre><pre class="cython line score-0">&#xA0;<span class="">0091</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0092</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Invalid temporal_model: {value}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-14 '>    __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_builtin_ValueError);
    __pyx_t_3 = __pyx_builtin_ValueError; 
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_int</span>(__pyx_v_value, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 92, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_Invalid_temporal_model, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 92, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_5};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 92, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 92, __pyx_L1_error)</span>
    break;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0093</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0094</span>:     <span class="nd">@property</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_19PyTableCapabilities_11enable_mvcc_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8marbledb_19PyTableCapabilities_11enable_mvcc_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_19PyTableCapabilities_11enable_mvcc___get__(((struct __pyx_obj_8marbledb_PyTableCapabilities *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_19PyTableCapabilities_11enable_mvcc___get__(struct __pyx_obj_8marbledb_PyTableCapabilities *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTableCapabilities.enable_mvcc.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0095</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">enable_mvcc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0096</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">caps</span><span class="o">.</span><span class="n">enable_mvcc</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_self-&gt;caps-&gt;enable_mvcc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 96, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0097</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0098</span>:     <span class="nd">@enable_mvcc</span><span class="o">.</span><span class="n">setter</span></pre>
<pre class='cython code score-11 '>/* Python wrapper */
static int __pyx_pw_8marbledb_19PyTableCapabilities_11enable_mvcc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value); /*proto*/
static int __pyx_pw_8marbledb_19PyTableCapabilities_11enable_mvcc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value) {
  bool __pyx_v_value;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  assert(__pyx_arg_value); {
    __pyx_v_value = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_arg_value); if (unlikely((__pyx_v_value == ((bool)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTableCapabilities.enable_mvcc.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8marbledb_19PyTableCapabilities_11enable_mvcc_2__set__(((struct __pyx_obj_8marbledb_PyTableCapabilities *)__pyx_v_self), ((bool)__pyx_v_value));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_8marbledb_19PyTableCapabilities_11enable_mvcc_2__set__(struct __pyx_obj_8marbledb_PyTableCapabilities *__pyx_v_self, bool __pyx_v_value) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0099</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">enable_mvcc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">bool</span> <span class="n">value</span><span class="p">):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0100</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">caps</span><span class="o">.</span><span class="n">enable_mvcc</span> <span class="o">=</span> <span class="n">value</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;caps-&gt;enable_mvcc = __pyx_v_value;
</pre><pre class="cython line score-0">&#xA0;<span class="">0101</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0102</span>:     <span class="nd">@property</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_19PyTableCapabilities_20max_versions_per_key_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8marbledb_19PyTableCapabilities_20max_versions_per_key_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_19PyTableCapabilities_20max_versions_per_key___get__(((struct __pyx_obj_8marbledb_PyTableCapabilities *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_19PyTableCapabilities_20max_versions_per_key___get__(struct __pyx_obj_8marbledb_PyTableCapabilities *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTableCapabilities.max_versions_per_key.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0103</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">max_versions_per_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0104</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">caps</span><span class="o">.</span><span class="n">mvcc_settings</span><span class="o">.</span><span class="n">max_versions_per_key</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyLong_FromSize_t</span>(__pyx_v_self-&gt;caps-&gt;mvcc_settings.max_versions_per_key);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0105</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0106</span>:     <span class="nd">@max_versions_per_key</span><span class="o">.</span><span class="n">setter</span></pre>
<pre class='cython code score-11 '>/* Python wrapper */
static int __pyx_pw_8marbledb_19PyTableCapabilities_20max_versions_per_key_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value); /*proto*/
static int __pyx_pw_8marbledb_19PyTableCapabilities_20max_versions_per_key_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value) {
  size_t __pyx_v_value;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  assert(__pyx_arg_value); {
    __pyx_v_value = <span class='pyx_c_api'>__Pyx_PyLong_As_size_t</span>(__pyx_arg_value); if (unlikely((__pyx_v_value == (size_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 107, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTableCapabilities.max_versions_per_key.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8marbledb_19PyTableCapabilities_20max_versions_per_key_2__set__(((struct __pyx_obj_8marbledb_PyTableCapabilities *)__pyx_v_self), ((size_t)__pyx_v_value));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_8marbledb_19PyTableCapabilities_20max_versions_per_key_2__set__(struct __pyx_obj_8marbledb_PyTableCapabilities *__pyx_v_self, size_t __pyx_v_value) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0107</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">max_versions_per_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">value</span><span class="p">):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0108</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">caps</span><span class="o">.</span><span class="n">mvcc_settings</span><span class="o">.</span><span class="n">max_versions_per_key</span> <span class="o">=</span> <span class="n">value</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;caps-&gt;mvcc_settings.max_versions_per_key = __pyx_v_value;
</pre><pre class="cython line score-0">&#xA0;<span class="">0109</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0110</span>:     <span class="nd">@property</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_19PyTableCapabilities_9gc_policy_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8marbledb_19PyTableCapabilities_9gc_policy_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_19PyTableCapabilities_9gc_policy___get__(((struct __pyx_obj_8marbledb_PyTableCapabilities *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_19PyTableCapabilities_9gc_policy___get__(struct __pyx_obj_8marbledb_PyTableCapabilities *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTableCapabilities.gc_policy.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0111</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">gc_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0112</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get GC policy (GC_KEEP_ALL, GC_KEEP_RECENT, GC_KEEP_UNTIL).&quot;&quot;&quot;</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0113</span>:         <span class="k">return</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">caps</span><span class="o">.</span><span class="n">mvcc_settings</span><span class="o">.</span><span class="n">gc_policy</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(((int)__pyx_v_self-&gt;caps-&gt;mvcc_settings.gc_policy));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0114</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0115</span>:     <span class="nd">@gc_policy</span><span class="o">.</span><span class="n">setter</span></pre>
<pre class='cython code score-18 '>/* Python wrapper */
static int __pyx_pw_8marbledb_19PyTableCapabilities_9gc_policy_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value); /*proto*/
static int __pyx_pw_8marbledb_19PyTableCapabilities_9gc_policy_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value) {
  int __pyx_v_value;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  assert(__pyx_arg_value); {
    __pyx_v_value = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(__pyx_arg_value); if (unlikely((__pyx_v_value == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 116, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTableCapabilities.gc_policy.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8marbledb_19PyTableCapabilities_9gc_policy_2__set__(((struct __pyx_obj_8marbledb_PyTableCapabilities *)__pyx_v_self), ((int)__pyx_v_value));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_8marbledb_19PyTableCapabilities_9gc_policy_2__set__(struct __pyx_obj_8marbledb_PyTableCapabilities *__pyx_v_self, int __pyx_v_value) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTableCapabilities.gc_policy.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0116</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">gc_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">value</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0117</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Set GC policy.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0118</span>:         <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  switch (__pyx_v_value) {
    case 0:
/* … */
    break;
    case 1:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0119</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">caps</span><span class="o">.</span><span class="n">mvcc_settings</span><span class="o">.</span><span class="n">gc_policy</span> <span class="o">=</span> <span class="n">TableCapabilities</span><span class="o">.</span><span class="n">MVCCSettings</span><span class="o">.</span><span class="n">GCPolicy</span><span class="o">.</span><span class="n">kKeepAllVersions</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;caps-&gt;mvcc_settings.gc_policy = marble::TableCapabilities::MVCCSettings::GCPolicy::kKeepAllVersions;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0120</span>:         <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 2:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0121</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">caps</span><span class="o">.</span><span class="n">mvcc_settings</span><span class="o">.</span><span class="n">gc_policy</span> <span class="o">=</span> <span class="n">TableCapabilities</span><span class="o">.</span><span class="n">MVCCSettings</span><span class="o">.</span><span class="n">GCPolicy</span><span class="o">.</span><span class="n">kKeepRecentVersions</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;caps-&gt;mvcc_settings.gc_policy = marble::TableCapabilities::MVCCSettings::GCPolicy::kKeepRecentVersions;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0122</span>:         <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0123</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">caps</span><span class="o">.</span><span class="n">mvcc_settings</span><span class="o">.</span><span class="n">gc_policy</span> <span class="o">=</span> <span class="n">TableCapabilities</span><span class="o">.</span><span class="n">MVCCSettings</span><span class="o">.</span><span class="n">GCPolicy</span><span class="o">.</span><span class="n">kKeepVersionsUntil</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;caps-&gt;mvcc_settings.gc_policy = marble::TableCapabilities::MVCCSettings::GCPolicy::kKeepVersionsUntil;
</pre><pre class="cython line score-0">&#xA0;<span class="">0124</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0125</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Invalid gc_policy: {value}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-14 '>    __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_builtin_ValueError);
    __pyx_t_3 = __pyx_builtin_ValueError; 
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_int</span>(__pyx_v_value, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 125, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_Invalid_gc_policy, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 125, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_5};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 125, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 125, __pyx_L1_error)</span>
    break;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0126</span>: </pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0127</span>:     <span class="nd">@staticmethod</span></pre>
<pre class='cython code score-70 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_19PyTableCapabilities_5bitemporal(CYTHON_UNUSED PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_19PyTableCapabilities_4bitemporal, "PyTableCapabilities.bitemporal(size_t max_versions=10, int gc_policy=GC_KEEP_RECENT)\n\nCreate TableCapabilities for a bitemporal table.\n\nArgs:\n    max_versions: Maximum versions to keep per key (for GC_KEEP_RECENT)\n    gc_policy: GC policy (GC_KEEP_ALL, GC_KEEP_RECENT, GC_KEEP_UNTIL)\n\nReturns:\n    PyTableCapabilities configured for bitemporal storage\n\nExample:\n    caps = PyTableCapabilities.bitemporal(max_versions=5)\n    db.create_table(\"employees\", schema, caps)");
static PyMethodDef __pyx_mdef_8marbledb_19PyTableCapabilities_5bitemporal = {"bitemporal", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_19PyTableCapabilities_5bitemporal, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_19PyTableCapabilities_4bitemporal};
static PyObject *__pyx_pw_8marbledb_19PyTableCapabilities_5bitemporal(CYTHON_UNUSED PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  size_t __pyx_v_max_versions;
  int __pyx_v_gc_policy;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("bitemporal (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_max_versions,&amp;__pyx_mstate_global-&gt;__pyx_n_u_gc_policy,0};
  PyObject* values[2] = {0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "bitemporal", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L3_error)</span>
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_max_versions = <span class='pyx_c_api'>__Pyx_PyLong_As_size_t</span>(values[0]); if (unlikely((__pyx_v_max_versions == (size_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 128, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_versions = ((size_t)10);
    }
    if (values[1]) {
      __pyx_v_gc_policy = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(values[1]); if (unlikely((__pyx_v_gc_policy == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 128, __pyx_L3_error)</span>
    } else {
      __pyx_v_gc_policy = __pyx_mstate_global-&gt;__pyx_k_;
    }
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("bitemporal", 0, 0, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTableCapabilities.bitemporal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8marbledb_19PyTableCapabilities_4bitemporal(__pyx_v_max_versions, __pyx_v_gc_policy);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_19PyTableCapabilities_4bitemporal(size_t __pyx_v_max_versions, int __pyx_v_gc_policy) {
  struct __pyx_obj_8marbledb_PyTableCapabilities *__pyx_v_caps = NULL;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTableCapabilities.bitemporal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_caps);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_4 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_mstate_global-&gt;__pyx_int_10, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_19PyTableCapabilities_5bitemporal, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyTableCapabilities_bitemporal, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[0]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyTableCapabilities, __pyx_mstate_global-&gt;__pyx_n_u_bitemporal, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_builtin_staticmethod);
  __pyx_t_5 = __pyx_builtin_staticmethod; 
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_2, (PyObject*)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyTableCapabilities, __pyx_mstate_global-&gt;__pyx_n_u_bitemporal);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_2};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  }
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyTableCapabilities, __pyx_mstate_global-&gt;__pyx_n_u_bitemporal, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0128</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">bitemporal</span><span class="p">(</span><span class="n">size_t</span> <span class="n">max_versions</span><span class="o">=</span><span class="mf">10</span><span class="p">,</span> <span class="nb">int</span> <span class="n">gc_policy</span><span class="o">=</span><span class="n">GC_KEEP_RECENT</span><span class="p">):</span></pre>
<pre class='cython code score-22 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_GC_KEEP_RECENT);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(__pyx_t_3); if (unlikely((__pyx_t_6 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 128, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_mstate_global-&gt;__pyx_k_ = __pyx_t_6;
/* … */
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_GC_KEEP_RECENT);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(__pyx_t_3); if (unlikely((__pyx_t_6 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 128, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-0">&#xA0;<span class="">0129</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Create TableCapabilities for a bitemporal table.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0130</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0131</span>: <span class="sd">        Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0132</span>: <span class="sd">            max_versions: Maximum versions to keep per key (for GC_KEEP_RECENT)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0133</span>: <span class="sd">            gc_policy: GC policy (GC_KEEP_ALL, GC_KEEP_RECENT, GC_KEEP_UNTIL)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0134</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0135</span>: <span class="sd">        Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0136</span>: <span class="sd">            PyTableCapabilities configured for bitemporal storage</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0137</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0138</span>: <span class="sd">        Example:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0139</span>: <span class="sd">            caps = PyTableCapabilities.bitemporal(max_versions=5)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0140</span>: <span class="sd">            db.create_table(&quot;employees&quot;, schema, caps)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0141</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0142</span>:         <span class="n">caps</span> <span class="o">=</span> <span class="n">PyTableCapabilities</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyTableCapabilities);
  __pyx_t_3 = ((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyTableCapabilities); 
  __pyx_t_4 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_4, (1-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 142, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_t_1);
  }
  __pyx_v_caps = ((struct __pyx_obj_8marbledb_PyTableCapabilities *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0143</span>:         <span class="n">caps</span><span class="o">.</span><span class="n">temporal_model</span> <span class="o">=</span> <span class="n">TEMPORAL_BITEMPORAL</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_n_u_TEMPORAL_BITEMPORAL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(((PyObject *)__pyx_v_caps), __pyx_mstate_global-&gt;__pyx_n_u_temporal_model, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0144</span>:         <span class="n">caps</span><span class="o">.</span><span class="n">enable_mvcc</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-2 '>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(((PyObject *)__pyx_v_caps), __pyx_mstate_global-&gt;__pyx_n_u_enable_mvcc, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 144, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0145</span>:         <span class="n">caps</span><span class="o">.</span><span class="n">max_versions_per_key</span> <span class="o">=</span> <span class="n">max_versions</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyLong_FromSize_t</span>(__pyx_v_max_versions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(((PyObject *)__pyx_v_caps), __pyx_mstate_global-&gt;__pyx_n_u_max_versions_per_key, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0146</span>:         <span class="n">caps</span><span class="o">.</span><span class="n">gc_policy</span> <span class="o">=</span> <span class="n">gc_policy</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_gc_policy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(((PyObject *)__pyx_v_caps), __pyx_mstate_global-&gt;__pyx_n_u_gc_policy, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0147</span>:         <span class="k">return</span> <span class="n">caps</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_caps);
  __pyx_r = ((PyObject *)__pyx_v_caps);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0148</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0149</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0150</span>: <span class="k">cdef</span><span class="w"> </span><span class="k">class</span> <span class="nf">PyDBOptions</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_8marbledb_PyDBOptions {
  PyObject_HEAD
  marble::DBOptions *opts;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">0151</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Python wrapper for MarbleDB DBOptions.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0152</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">DBOptions</span>* <span class="nf">opts</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0153</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0154</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-14 '>/* Python wrapper */
static int __pyx_pw_8marbledb_11PyDBOptions_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_8marbledb_11PyDBOptions_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return -1;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_VARARGS</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return -1;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("__cinit__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_8marbledb_11PyDBOptions___cinit__(((struct __pyx_obj_8marbledb_PyDBOptions *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_8marbledb_11PyDBOptions___cinit__(struct __pyx_obj_8marbledb_PyDBOptions *__pyx_v_self) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0155</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">opts</span> <span class="o">=</span> <span class="n">new</span> <span class="n">DBOptions</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;opts = new marble::DBOptions();
</pre><pre class="cython line score-0">&#xA0;<span class="">0156</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0157</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__dealloc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>/* Python wrapper */
static void __pyx_pw_8marbledb_11PyDBOptions_3__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_8marbledb_11PyDBOptions_3__dealloc__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_pf_8marbledb_11PyDBOptions_2__dealloc__(((struct __pyx_obj_8marbledb_PyDBOptions *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

static void __pyx_pf_8marbledb_11PyDBOptions_2__dealloc__(struct __pyx_obj_8marbledb_PyDBOptions *__pyx_v_self) {
/* … */
  /* function exit code */
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0158</span>:         <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">opts</span></pre>
<pre class='cython code score-0 '>  delete __pyx_v_self-&gt;opts;
</pre><pre class="cython line score-0">&#xA0;<span class="">0159</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0160</span>:     <span class="nd">@property</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_11PyDBOptions_7db_path_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8marbledb_11PyDBOptions_7db_path_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_11PyDBOptions_7db_path___get__(((struct __pyx_obj_8marbledb_PyDBOptions *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_11PyDBOptions_7db_path___get__(struct __pyx_obj_8marbledb_PyDBOptions *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyDBOptions.db_path.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0161</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">db_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0162</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">db_path</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __Pyx_decode_cpp_string(__pyx_v_self-&gt;opts-&gt;db_path, 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0163</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0164</span>:     <span class="nd">@db_path</span><span class="o">.</span><span class="n">setter</span></pre>
<pre class='cython code score-7 '>/* Python wrapper */
static int __pyx_pw_8marbledb_11PyDBOptions_7db_path_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_path); /*proto*/
static int __pyx_pw_8marbledb_11PyDBOptions_7db_path_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_path) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_path), (&amp;PyUnicode_Type), 1, "path", 1))) <span class='error_goto'>__PYX_ERR(0, 165, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8marbledb_11PyDBOptions_7db_path_2__set__(((struct __pyx_obj_8marbledb_PyDBOptions *)__pyx_v_self), ((PyObject*)__pyx_v_path));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  goto __pyx_L5_cleaned_up;
  __pyx_L0:;
  __pyx_L5_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_8marbledb_11PyDBOptions_7db_path_2__set__(struct __pyx_obj_8marbledb_PyDBOptions *__pyx_v_self, PyObject *__pyx_v_path) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyDBOptions.db_path.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0165</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">db_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">path</span><span class="p">):</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0166</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">db_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-6 '>  if (unlikely(__pyx_v_path == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "encode");
    <span class='error_goto'>__PYX_ERR(0, 166, __pyx_L1_error)</span>
  }
  __pyx_t_1 = PyUnicode_AsUTF8String(__pyx_v_path);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 166, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_1);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 166, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_self-&gt;opts-&gt;db_path = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0167</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0168</span>:     <span class="nd">@property</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_11PyDBOptions_10enable_wal_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8marbledb_11PyDBOptions_10enable_wal_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_11PyDBOptions_10enable_wal___get__(((struct __pyx_obj_8marbledb_PyDBOptions *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_11PyDBOptions_10enable_wal___get__(struct __pyx_obj_8marbledb_PyDBOptions *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyDBOptions.enable_wal.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0169</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">enable_wal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0170</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">enable_wal</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_self-&gt;opts-&gt;enable_wal);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 170, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0171</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0172</span>:     <span class="nd">@enable_wal</span><span class="o">.</span><span class="n">setter</span></pre>
<pre class='cython code score-11 '>/* Python wrapper */
static int __pyx_pw_8marbledb_11PyDBOptions_10enable_wal_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value); /*proto*/
static int __pyx_pw_8marbledb_11PyDBOptions_10enable_wal_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value) {
  bool __pyx_v_value;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  assert(__pyx_arg_value); {
    __pyx_v_value = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_arg_value); if (unlikely((__pyx_v_value == ((bool)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 173, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyDBOptions.enable_wal.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8marbledb_11PyDBOptions_10enable_wal_2__set__(((struct __pyx_obj_8marbledb_PyDBOptions *)__pyx_v_self), ((bool)__pyx_v_value));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_8marbledb_11PyDBOptions_10enable_wal_2__set__(struct __pyx_obj_8marbledb_PyDBOptions *__pyx_v_self, bool __pyx_v_value) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0173</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">enable_wal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">bool</span> <span class="n">value</span><span class="p">):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0174</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">enable_wal</span> <span class="o">=</span> <span class="n">value</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;opts-&gt;enable_wal = __pyx_v_value;
</pre><pre class="cython line score-0">&#xA0;<span class="">0175</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0176</span>:     <span class="nd">@property</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_11PyDBOptions_19enable_sparse_index_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8marbledb_11PyDBOptions_19enable_sparse_index_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_11PyDBOptions_19enable_sparse_index___get__(((struct __pyx_obj_8marbledb_PyDBOptions *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_11PyDBOptions_19enable_sparse_index___get__(struct __pyx_obj_8marbledb_PyDBOptions *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyDBOptions.enable_sparse_index.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0177</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">enable_sparse_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0178</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">enable_sparse_index</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_self-&gt;opts-&gt;enable_sparse_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0179</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0180</span>:     <span class="nd">@enable_sparse_index</span><span class="o">.</span><span class="n">setter</span></pre>
<pre class='cython code score-11 '>/* Python wrapper */
static int __pyx_pw_8marbledb_11PyDBOptions_19enable_sparse_index_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value); /*proto*/
static int __pyx_pw_8marbledb_11PyDBOptions_19enable_sparse_index_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value) {
  bool __pyx_v_value;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  assert(__pyx_arg_value); {
    __pyx_v_value = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_arg_value); if (unlikely((__pyx_v_value == ((bool)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 181, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyDBOptions.enable_sparse_index.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8marbledb_11PyDBOptions_19enable_sparse_index_2__set__(((struct __pyx_obj_8marbledb_PyDBOptions *)__pyx_v_self), ((bool)__pyx_v_value));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_8marbledb_11PyDBOptions_19enable_sparse_index_2__set__(struct __pyx_obj_8marbledb_PyDBOptions *__pyx_v_self, bool __pyx_v_value) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0181</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">enable_sparse_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">bool</span> <span class="n">value</span><span class="p">):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0182</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">enable_sparse_index</span> <span class="o">=</span> <span class="n">value</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;opts-&gt;enable_sparse_index = __pyx_v_value;
</pre><pre class="cython line score-0">&#xA0;<span class="">0183</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0184</span>:     <span class="nd">@property</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_11PyDBOptions_15wal_buffer_size_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8marbledb_11PyDBOptions_15wal_buffer_size_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_11PyDBOptions_15wal_buffer_size___get__(((struct __pyx_obj_8marbledb_PyDBOptions *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_11PyDBOptions_15wal_buffer_size___get__(struct __pyx_obj_8marbledb_PyDBOptions *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyDBOptions.wal_buffer_size.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0185</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">wal_buffer_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0186</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">wal_buffer_size</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyLong_FromSize_t</span>(__pyx_v_self-&gt;opts-&gt;wal_buffer_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0187</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0188</span>:     <span class="nd">@wal_buffer_size</span><span class="o">.</span><span class="n">setter</span></pre>
<pre class='cython code score-11 '>/* Python wrapper */
static int __pyx_pw_8marbledb_11PyDBOptions_15wal_buffer_size_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value); /*proto*/
static int __pyx_pw_8marbledb_11PyDBOptions_15wal_buffer_size_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value) {
  size_t __pyx_v_value;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  assert(__pyx_arg_value); {
    __pyx_v_value = <span class='pyx_c_api'>__Pyx_PyLong_As_size_t</span>(__pyx_arg_value); if (unlikely((__pyx_v_value == (size_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyDBOptions.wal_buffer_size.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8marbledb_11PyDBOptions_15wal_buffer_size_2__set__(((struct __pyx_obj_8marbledb_PyDBOptions *)__pyx_v_self), ((size_t)__pyx_v_value));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_8marbledb_11PyDBOptions_15wal_buffer_size_2__set__(struct __pyx_obj_8marbledb_PyDBOptions *__pyx_v_self, size_t __pyx_v_value) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0189</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">wal_buffer_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">value</span><span class="p">):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0190</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">wal_buffer_size</span> <span class="o">=</span> <span class="n">value</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;opts-&gt;wal_buffer_size = __pyx_v_value;
</pre><pre class="cython line score-0">&#xA0;<span class="">0191</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0192</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0193</span>: <span class="k">cdef</span><span class="w"> </span><span class="k">class</span> <span class="nf">PyColumnFamilyOptions</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_8marbledb_PyColumnFamilyOptions {
  PyObject_HEAD
  marble::ColumnFamilyOptions *opts;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">0194</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Python wrapper for ColumnFamilyOptions.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0195</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">ColumnFamilyOptions</span>* <span class="nf">opts</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0196</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0197</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-14 '>/* Python wrapper */
static int __pyx_pw_8marbledb_21PyColumnFamilyOptions_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_8marbledb_21PyColumnFamilyOptions_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return -1;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_VARARGS</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return -1;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("__cinit__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_8marbledb_21PyColumnFamilyOptions___cinit__(((struct __pyx_obj_8marbledb_PyColumnFamilyOptions *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_8marbledb_21PyColumnFamilyOptions___cinit__(struct __pyx_obj_8marbledb_PyColumnFamilyOptions *__pyx_v_self) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0198</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">opts</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ColumnFamilyOptions</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;opts = new marble::ColumnFamilyOptions();
</pre><pre class="cython line score-0">&#xA0;<span class="">0199</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0200</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__dealloc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>/* Python wrapper */
static void __pyx_pw_8marbledb_21PyColumnFamilyOptions_3__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_8marbledb_21PyColumnFamilyOptions_3__dealloc__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_pf_8marbledb_21PyColumnFamilyOptions_2__dealloc__(((struct __pyx_obj_8marbledb_PyColumnFamilyOptions *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

static void __pyx_pf_8marbledb_21PyColumnFamilyOptions_2__dealloc__(struct __pyx_obj_8marbledb_PyColumnFamilyOptions *__pyx_v_self) {
/* … */
  /* function exit code */
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0201</span>:         <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">opts</span></pre>
<pre class='cython code score-0 '>  delete __pyx_v_self-&gt;opts;
</pre><pre class="cython line score-0">&#xA0;<span class="">0202</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0203</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">set_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">):</span></pre>
<pre class='cython code score-31 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_21PyColumnFamilyOptions_5set_schema(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_21PyColumnFamilyOptions_4set_schema, "PyColumnFamilyOptions.set_schema(self, schema)\n\nSet Arrow schema for this column family.");
static PyMethodDef __pyx_mdef_8marbledb_21PyColumnFamilyOptions_5set_schema = {"set_schema", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_21PyColumnFamilyOptions_5set_schema, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_21PyColumnFamilyOptions_4set_schema};
static PyObject *__pyx_pw_8marbledb_21PyColumnFamilyOptions_5set_schema(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_schema = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_schema (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_schema,0};
  PyObject* values[1] = {0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "set_schema", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 1; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_schema", 1, 1, 1, i); <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L3_error)</span>
    }
    __pyx_v_schema = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_schema", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyColumnFamilyOptions.set_schema", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8marbledb_21PyColumnFamilyOptions_4set_schema(((struct __pyx_obj_8marbledb_PyColumnFamilyOptions *)__pyx_v_self), __pyx_v_schema);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_21PyColumnFamilyOptions_4set_schema(struct __pyx_obj_8marbledb_PyColumnFamilyOptions *__pyx_v_self, PyObject *__pyx_v_schema) {
  std::shared_ptr&lt; arrow::Schema&gt;  __pyx_v_c_schema;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyColumnFamilyOptions.set_schema", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_21PyColumnFamilyOptions_5set_schema, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyColumnFamilyOptions_set_schema, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[5]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 203, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyColumnFamilyOptions, __pyx_mstate_global-&gt;__pyx_n_u_set_schema, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0204</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Set Arrow schema for this column family.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0205</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">CSchema</span>] <span class="nf">c_schema</span><span class="w"> </span><span class="o">=</span> <span class="n">pyarrow_unwrap_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_f_7pyarrow_3lib_pyarrow_unwrap_schema(__pyx_v_schema);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 205, __pyx_L1_error)</span>
  __pyx_v_c_schema = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0206</span>:         <span class="n">deref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="p">)</span><span class="o">.</span><span class="n">schema</span> <span class="o">=</span> <span class="n">c_schema</span></pre>
<pre class='cython code score-0 '>  (*__pyx_v_self-&gt;opts).schema = __pyx_v_c_schema;
</pre><pre class="cython line score-0">&#xA0;<span class="">0207</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0208</span>:     <span class="nd">@property</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_21PyColumnFamilyOptions_19enable_bloom_filter_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8marbledb_21PyColumnFamilyOptions_19enable_bloom_filter_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_21PyColumnFamilyOptions_19enable_bloom_filter___get__(((struct __pyx_obj_8marbledb_PyColumnFamilyOptions *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_21PyColumnFamilyOptions_19enable_bloom_filter___get__(struct __pyx_obj_8marbledb_PyColumnFamilyOptions *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyColumnFamilyOptions.enable_bloom_filter.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0209</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">enable_bloom_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0210</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">enable_bloom_filter</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_self-&gt;opts-&gt;enable_bloom_filter);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 210, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0211</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0212</span>:     <span class="nd">@enable_bloom_filter</span><span class="o">.</span><span class="n">setter</span></pre>
<pre class='cython code score-11 '>/* Python wrapper */
static int __pyx_pw_8marbledb_21PyColumnFamilyOptions_19enable_bloom_filter_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value); /*proto*/
static int __pyx_pw_8marbledb_21PyColumnFamilyOptions_19enable_bloom_filter_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_arg_value) {
  bool __pyx_v_value;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  assert(__pyx_arg_value); {
    __pyx_v_value = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_arg_value); if (unlikely((__pyx_v_value == ((bool)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 213, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyColumnFamilyOptions.enable_bloom_filter.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8marbledb_21PyColumnFamilyOptions_19enable_bloom_filter_2__set__(((struct __pyx_obj_8marbledb_PyColumnFamilyOptions *)__pyx_v_self), ((bool)__pyx_v_value));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_8marbledb_21PyColumnFamilyOptions_19enable_bloom_filter_2__set__(struct __pyx_obj_8marbledb_PyColumnFamilyOptions *__pyx_v_self, bool __pyx_v_value) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0213</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">enable_bloom_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">bool</span> <span class="n">value</span><span class="p">):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0214</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">enable_bloom_filter</span> <span class="o">=</span> <span class="n">value</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;opts-&gt;enable_bloom_filter = __pyx_v_value;
</pre><pre class="cython line score-0">&#xA0;<span class="">0215</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0216</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0217</span>: <span class="k">cdef</span><span class="w"> </span><span class="k">class</span> <span class="nf">PyTripleKey</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_8marbledb_PyTripleKey {
  PyObject_HEAD
  std::shared_ptr&lt;marble::TripleKey&gt;  key;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">0218</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Python wrapper for TripleKey.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0219</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">TripleKey</span>] <span class="nf">key</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0220</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0221</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">int64_t</span> <span class="n">subject</span><span class="p">,</span> <span class="n">int64_t</span> <span class="n">predicate</span><span class="p">,</span> <span class="n">int64_t</span> <span class="n">obj</span><span class="p">):</span></pre>
<pre class='cython code score-47 '>/* Python wrapper */
static int __pyx_pw_8marbledb_11PyTripleKey_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_8marbledb_11PyTripleKey_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int64_t __pyx_v_subject;
  int64_t __pyx_v_predicate;
  int64_t __pyx_v_obj;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return -1;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_subject,&amp;__pyx_mstate_global-&gt;__pyx_n_u_predicate,&amp;__pyx_mstate_global-&gt;__pyx_n_u_obj,0};
  PyObject* values[3] = {0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_VARARGS</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_VARARGS</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_VARARGS</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_VARARGS</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__cinit__", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 3; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 3, 3, i); <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_VARARGS</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_VARARGS</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span>
      values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_VARARGS</span>(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span>
    }
    __pyx_v_subject = __Pyx_PyLong_As_int64_t(values[0]); if (unlikely((__pyx_v_subject == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span>
    __pyx_v_predicate = __Pyx_PyLong_As_int64_t(values[1]); if (unlikely((__pyx_v_predicate == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span>
    __pyx_v_obj = __Pyx_PyLong_As_int64_t(values[2]); if (unlikely((__pyx_v_obj == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span>
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 3, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTripleKey.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8marbledb_11PyTripleKey___cinit__(((struct __pyx_obj_8marbledb_PyTripleKey *)__pyx_v_self), __pyx_v_subject, __pyx_v_predicate, __pyx_v_obj);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_8marbledb_11PyTripleKey___cinit__(struct __pyx_obj_8marbledb_PyTripleKey *__pyx_v_self, int64_t __pyx_v_subject, int64_t __pyx_v_predicate, int64_t __pyx_v_obj) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTripleKey.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0222</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">make_shared</span><span class="p">[</span><span class="n">TripleKey</span><span class="p">](</span><span class="n">subject</span><span class="p">,</span> <span class="n">predicate</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  try {
    __pyx_t_1 = std::make_shared&lt;marble::TripleKey&gt;(__pyx_v_subject, __pyx_v_predicate, __pyx_v_obj);
  } catch(...) {
    __Pyx_CppExn2PyErr();
    <span class='error_goto'>__PYX_ERR(0, 222, __pyx_L1_error)</span>
  }
  __pyx_v_self-&gt;key = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0223</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0224</span>:     <span class="nd">@property</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_11PyTripleKey_7subject_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8marbledb_11PyTripleKey_7subject_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_11PyTripleKey_7subject___get__(((struct __pyx_obj_8marbledb_PyTripleKey *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_11PyTripleKey_7subject___get__(struct __pyx_obj_8marbledb_PyTripleKey *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTripleKey.subject.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0225</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">subject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0226</span>:         <span class="k">return</span> <span class="n">deref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">subject</span><span class="p">()</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __Pyx_PyLong_From_int64_t((*__pyx_v_self-&gt;key).subject());<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 226, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0227</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0228</span>:     <span class="nd">@property</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_11PyTripleKey_9predicate_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8marbledb_11PyTripleKey_9predicate_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_11PyTripleKey_9predicate___get__(((struct __pyx_obj_8marbledb_PyTripleKey *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_11PyTripleKey_9predicate___get__(struct __pyx_obj_8marbledb_PyTripleKey *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTripleKey.predicate.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0229</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">predicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0230</span>:         <span class="k">return</span> <span class="n">deref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">predicate</span><span class="p">()</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __Pyx_PyLong_From_int64_t((*__pyx_v_self-&gt;key).predicate());<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 230, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0231</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0232</span>:     <span class="nd">@property</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_11PyTripleKey_6object_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8marbledb_11PyTripleKey_6object_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_11PyTripleKey_6object___get__(((struct __pyx_obj_8marbledb_PyTripleKey *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_11PyTripleKey_6object___get__(struct __pyx_obj_8marbledb_PyTripleKey *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTripleKey.object.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0233</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">object</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0234</span>:         <span class="k">return</span> <span class="n">deref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">object</span><span class="p">()</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __Pyx_PyLong_From_int64_t((*__pyx_v_self-&gt;key).object());<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0235</span>: </pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0236</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PyTripleKey</span> <span class="n">other</span><span class="p">):</span></pre>
<pre class='cython code score-33 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_11PyTripleKey_3compare(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_11PyTripleKey_2compare, "PyTripleKey.compare(self, PyTripleKey other)\n\nCompare this key with another. Returns -1, 0, or 1.");
static PyMethodDef __pyx_mdef_8marbledb_11PyTripleKey_3compare = {"compare", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_11PyTripleKey_3compare, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_11PyTripleKey_2compare};
static PyObject *__pyx_pw_8marbledb_11PyTripleKey_3compare(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  struct __pyx_obj_8marbledb_PyTripleKey *__pyx_v_other = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compare (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_other,0};
  PyObject* values[1] = {0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 236, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 236, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "compare", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 236, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 1; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compare", 1, 1, 1, i); <span class='error_goto'>__PYX_ERR(0, 236, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 236, __pyx_L3_error)</span>
    }
    __pyx_v_other = ((struct __pyx_obj_8marbledb_PyTripleKey *)values[0]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compare", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 236, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTripleKey.compare", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_other), __pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyTripleKey, 1, "other", 0))) <span class='error_goto'>__PYX_ERR(0, 236, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8marbledb_11PyTripleKey_2compare(((struct __pyx_obj_8marbledb_PyTripleKey *)__pyx_v_self), __pyx_v_other);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_11PyTripleKey_2compare(struct __pyx_obj_8marbledb_PyTripleKey *__pyx_v_self, struct __pyx_obj_8marbledb_PyTripleKey *__pyx_v_other) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTripleKey.compare", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_11PyTripleKey_3compare, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyTripleKey_compare, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[8]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 236, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyTripleKey, __pyx_mstate_global-&gt;__pyx_n_u_compare, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 236, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0237</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compare this key with another. Returns -1, 0, or 1.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0238</span>:         <span class="k">return</span> <span class="n">deref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">Compare</span><span class="p">(</span><span class="n">deref</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">key</span><span class="p">))</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>((*__pyx_v_self-&gt;key).Compare((*__pyx_v_other-&gt;key)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 238, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0239</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0240</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-8 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_11PyTripleKey_5__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8marbledb_11PyTripleKey_5__repr__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_11PyTripleKey_4__repr__(((struct __pyx_obj_8marbledb_PyTripleKey *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_11PyTripleKey_4__repr__(struct __pyx_obj_8marbledb_PyTripleKey *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyTripleKey.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0241</span>:         <span class="k">return</span> <span class="n">f</span><span class="s">&quot;TripleKey({self.subject}, {self.predicate}, {self.object})&quot;</span></pre>
<pre class='cython code score-33 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_mstate_global-&gt;__pyx_n_u_subject);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_mstate_global-&gt;__pyx_n_u_predicate);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_mstate_global-&gt;__pyx_n_u_object);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5[0] = __pyx_mstate_global-&gt;__pyx_kp_u_TripleKey;
  __pyx_t_5[1] = __pyx_t_2;
  __pyx_t_5[2] = __pyx_mstate_global-&gt;__pyx_kp_u__2;
  __pyx_t_5[3] = __pyx_t_3;
  __pyx_t_5[4] = __pyx_mstate_global-&gt;__pyx_kp_u__2;
  __pyx_t_5[5] = __pyx_t_4;
  __pyx_t_5[6] = __pyx_mstate_global-&gt;__pyx_kp_u__3;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_5, 7, 10 + <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_2) + 2 * 2 + <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3) + <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4) + 1, 127 | <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) | <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) | <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4));
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0242</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0243</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0244</span>: <span class="k">cdef</span><span class="w"> </span><span class="k">class</span> <span class="nf">PyIterator</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_8marbledb_PyIterator {
  PyObject_HEAD
  struct __pyx_vtabstruct_8marbledb_PyIterator *__pyx_vtab;
  std::unique_ptr&lt;marble::Iterator&gt;  it;
};
/* … */
struct __pyx_vtabstruct_8marbledb_PyIterator {
  void (*_set_iterator)(struct __pyx_obj_8marbledb_PyIterator *, std::unique_ptr&lt;marble::Iterator&gt;  &amp;);
};
static struct __pyx_vtabstruct_8marbledb_PyIterator *__pyx_vtabptr_8marbledb_PyIterator;

</pre><pre class="cython line score-0">&#xA0;<span class="">0245</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Python wrapper for MarbleDB Iterator.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0246</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">unique_ptr</span>[<span class="kt">Iterator</span>] <span class="nf">it</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0247</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0248</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">void</span> <span class="nf">_set_iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_ptr</span><span class="p">[</span><span class="n">Iterator</span><span class="p">]</span><span class="o">&amp;</span> <span class="n">iterator</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_8marbledb_10PyIterator__set_iterator(struct __pyx_obj_8marbledb_PyIterator *__pyx_v_self, std::unique_ptr&lt;marble::Iterator&gt;  &amp;__pyx_v_iterator) {
/* … */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0249</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal method to take ownership of C++ iterator.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0250</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">it</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;it.swap(__pyx_v_iterator);
</pre><pre class="cython line score-0">&#xA0;<span class="">0251</span>: </pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0252</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PyTripleKey</span> <span class="n">key</span><span class="p">):</span></pre>
<pre class='cython code score-36 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyIterator_1seek(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyIterator_seek, "PyIterator.seek(self, PyTripleKey key)\n\nSeek to the specified key.");
static PyMethodDef __pyx_mdef_8marbledb_10PyIterator_1seek = {"seek", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyIterator_1seek, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyIterator_seek};
static PyObject *__pyx_pw_8marbledb_10PyIterator_1seek(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  struct __pyx_obj_8marbledb_PyTripleKey *__pyx_v_key = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("seek (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_key,0};
  PyObject* values[1] = {0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "seek", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 1; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("seek", 1, 1, 1, i); <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L3_error)</span>
    }
    __pyx_v_key = ((struct __pyx_obj_8marbledb_PyTripleKey *)values[0]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("seek", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyIterator.seek", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_key), __pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyTripleKey, 1, "key", 0))) <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8marbledb_10PyIterator_seek(((struct __pyx_obj_8marbledb_PyIterator *)__pyx_v_self), __pyx_v_key);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyIterator_seek(struct __pyx_obj_8marbledb_PyIterator *__pyx_v_self, struct __pyx_obj_8marbledb_PyTripleKey *__pyx_v_key) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyIterator.seek", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyIterator_1seek, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyIterator_seek, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[11]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyIterator, __pyx_mstate_global-&gt;__pyx_n_u_seek, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0253</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Seek to the specified key.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0254</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">it</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;it.get() == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0255</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Iterator not initialized&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 255, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Iterator_not_initialized};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 255, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 255, __pyx_L1_error)</span>
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0256</span>:         <span class="n">deref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">it</span><span class="p">)</span><span class="o">.</span><span class="n">Seek</span><span class="p">(</span><span class="n">deref</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get</span><span class="p">()))</span></pre>
<pre class='cython code score-0 '>  (*__pyx_v_self-&gt;it).Seek((*__pyx_v_key-&gt;key.get()));
</pre><pre class="cython line score-0">&#xA0;<span class="">0257</span>: </pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0258</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-26 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyIterator_3next(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyIterator_2next, "PyIterator.next(self)\n\nMove to the next record.");
static PyMethodDef __pyx_mdef_8marbledb_10PyIterator_3next = {"next", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyIterator_3next, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyIterator_2next};
static PyObject *__pyx_pw_8marbledb_10PyIterator_3next(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("next (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("next", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return NULL;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("next", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_8marbledb_10PyIterator_2next(((struct __pyx_obj_8marbledb_PyIterator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyIterator_2next(struct __pyx_obj_8marbledb_PyIterator *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyIterator.next", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyIterator_3next, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyIterator_next, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[12]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyIterator, __pyx_mstate_global-&gt;__pyx_n_u_next, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 258, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0259</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Move to the next record.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0260</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">it</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;it.get() == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0261</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Iterator not initialized&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Iterator_not_initialized};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 261, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 261, __pyx_L1_error)</span>
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0262</span>:         <span class="n">deref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">it</span><span class="p">)</span><span class="o">.</span><span class="n">Next</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  (*__pyx_v_self-&gt;it).Next();
</pre><pre class="cython line score-0">&#xA0;<span class="">0263</span>: </pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0264</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-23 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyIterator_5valid(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyIterator_4valid, "PyIterator.valid(self)\n\nCheck if iterator is pointing to a valid record.");
static PyMethodDef __pyx_mdef_8marbledb_10PyIterator_5valid = {"valid", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyIterator_5valid, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyIterator_4valid};
static PyObject *__pyx_pw_8marbledb_10PyIterator_5valid(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("valid (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("valid", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return NULL;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("valid", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_8marbledb_10PyIterator_4valid(((struct __pyx_obj_8marbledb_PyIterator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyIterator_4valid(struct __pyx_obj_8marbledb_PyIterator *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyIterator.valid", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyIterator_5valid, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyIterator_valid, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[13]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 264, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyIterator, __pyx_mstate_global-&gt;__pyx_n_u_valid, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 264, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0265</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if iterator is pointing to a valid record.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0266</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">it</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;it.get() == NULL);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0267</span>:             <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
    __pyx_r = Py_False;
    goto __pyx_L0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0268</span>:         <span class="k">return</span> <span class="n">deref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">it</span><span class="p">)</span><span class="o">.</span><span class="n">Valid</span><span class="p">()</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>((*__pyx_v_self-&gt;it).Valid());<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0269</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0270</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-29 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyIterator_7key(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyIterator_6key, "PyIterator.key(self)\n\nGet current key as PyTripleKey.");
static PyMethodDef __pyx_mdef_8marbledb_10PyIterator_7key = {"key", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyIterator_7key, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyIterator_6key};
static PyObject *__pyx_pw_8marbledb_10PyIterator_7key(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("key (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("key", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return NULL;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("key", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_8marbledb_10PyIterator_6key(((struct __pyx_obj_8marbledb_PyIterator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyIterator_6key(struct __pyx_obj_8marbledb_PyIterator *__pyx_v_self) {
  std::shared_ptr&lt;marble::Key&gt;  __pyx_v_key_ptr;
  marble::TripleKey *__pyx_v_tk;
  struct __pyx_obj_8marbledb_PyTripleKey *__pyx_v_result = NULL;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyIterator.key", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_result);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyIterator_7key, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyIterator_key, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[14]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 270, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyIterator, __pyx_mstate_global-&gt;__pyx_n_u_key, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 270, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0271</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current key as PyTripleKey.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0272</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">it</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;it.get() == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0273</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Iterator not initialized&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 273, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Iterator_not_initialized};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 273, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 273, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0274</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0275</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">Key</span>] <span class="nf">key_ptr</span><span class="w"> </span><span class="o">=</span> <span class="n">deref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">it</span><span class="p">)</span><span class="o">.</span><span class="n">key</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_key_ptr = (*__pyx_v_self-&gt;it).key();
</pre><pre class="cython line score-0">&#xA0;<span class="">0276</span>:         <span class="c"># Cast to TripleKey</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0277</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">TripleKey</span>* <span class="nf">tk</span><span class="w"> </span><span class="o">=</span> <span class="o">&lt;</span><span class="n">TripleKey</span><span class="o">*&gt;</span><span class="n">key_ptr</span><span class="o">.</span><span class="n">get</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_tk = ((marble::TripleKey *)__pyx_v_key_ptr.get());
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0278</span>:         <span class="k">if</span> <span class="n">tk</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_tk == NULL);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0279</span>:             <span class="k">return</span> <span class="bp">None</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0280</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0281</span>:         <span class="n">result</span> <span class="o">=</span> <span class="n">PyTripleKey</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">subject</span><span class="p">(),</span> <span class="n">tk</span><span class="o">.</span><span class="n">predicate</span><span class="p">(),</span> <span class="n">tk</span><span class="o">.</span><span class="n">object</span><span class="p">())</span></pre>
<pre class='cython code score-8 '>  __pyx_t_4 = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyTripleKey);
  __pyx_t_3 = ((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyTripleKey); 
  __pyx_t_6 = __Pyx_PyLong_From_int64_t(__pyx_v_tk-&gt;subject());<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyLong_From_int64_t(__pyx_v_tk-&gt;predicate());<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = __Pyx_PyLong_From_int64_t(__pyx_v_tk-&gt;object());<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_5 = 1;
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_4, __pyx_t_6, __pyx_t_7, __pyx_t_8};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (4-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 281, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_t_2);
  }
  __pyx_v_result = ((struct __pyx_obj_8marbledb_PyTripleKey *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0282</span>:         <span class="k">return</span> <span class="n">result</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_result);
  __pyx_r = ((PyObject *)__pyx_v_result);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0283</span>: </pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0284</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-25 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyIterator_9value(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyIterator_8value, "PyIterator.value(self)\n\nGet current value as Record.\n\nNote: Returns the raw Record object. Use scan_table or temporal_scan_dedup\nfor RecordBatch results.");
static PyMethodDef __pyx_mdef_8marbledb_10PyIterator_9value = {"value", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyIterator_9value, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyIterator_8value};
static PyObject *__pyx_pw_8marbledb_10PyIterator_9value(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("value (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("value", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return NULL;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("value", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_8marbledb_10PyIterator_8value(((struct __pyx_obj_8marbledb_PyIterator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyIterator_8value(struct __pyx_obj_8marbledb_PyIterator *__pyx_v_self) {
  std::shared_ptr&lt;marble::Record&gt;  __pyx_v_record;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyIterator.value", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyIterator_9value, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyIterator_value, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[15]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 284, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyIterator, __pyx_mstate_global-&gt;__pyx_n_u_value, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0285</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current value as Record.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0286</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0287</span>: <span class="sd">        Note: Returns the raw Record object. Use scan_table or temporal_scan_dedup</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0288</span>: <span class="sd">        for RecordBatch results.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0289</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0290</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">it</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;it.get() == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0291</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Iterator not initialized&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 291, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Iterator_not_initialized};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 291, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 291, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0292</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0293</span>:         <span class="c"># Iterator returns Record, not RecordBatch directly</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0294</span>:         <span class="c"># For full batch results, use ScanTable or TemporalScanDedup instead</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0295</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">Record</span>] <span class="nf">record</span><span class="w"> </span><span class="o">=</span> <span class="n">deref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">it</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_record = (*__pyx_v_self-&gt;it).value();
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0296</span>:         <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_record.get() == NULL);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0297</span>:             <span class="k">return</span> <span class="bp">None</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0298</span>:         <span class="c"># Return None for now - use scan methods for batch results</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0299</span>:         <span class="k">return</span> <span class="bp">None</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0300</span>: </pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0301</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-27 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyIterator_11status(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyIterator_10status, "PyIterator.status(self)\n\nGet iterator status.");
static PyMethodDef __pyx_mdef_8marbledb_10PyIterator_11status = {"status", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyIterator_11status, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyIterator_10status};
static PyObject *__pyx_pw_8marbledb_10PyIterator_11status(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("status (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("status", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return NULL;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("status", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_8marbledb_10PyIterator_10status(((struct __pyx_obj_8marbledb_PyIterator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyIterator_10status(struct __pyx_obj_8marbledb_PyIterator *__pyx_v_self) {
  marble::Status __pyx_v_status;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyIterator.status", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyIterator_11status, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyIterator_status, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[16]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 301, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyIterator, __pyx_mstate_global-&gt;__pyx_n_u_status, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 301, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0302</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get iterator status.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0303</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">it</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;it.get() == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0304</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Iterator not initialized&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 304, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Iterator_not_initialized};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 304, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 304, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0305</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0306</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span><span class="w"> </span><span class="o">=</span> <span class="n">deref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">it</span><span class="p">)</span><span class="o">.</span><span class="n">status</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_status = (*__pyx_v_self-&gt;it).status();
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0307</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0308</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">status</span><span class="o">.</span><span class="n">ToString</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span></pre>
<pre class='cython code score-20 '>    __pyx_t_4 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_4);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_6};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0309</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0310</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyIterator_13__iter__(PyObject *__pyx_v_self); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyIterator_12__iter__, "PyIterator.__iter__(self)\n\nMake iterator iterable in Python.");
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_8marbledb_10PyIterator_12__iter__;
#endif
static PyObject *__pyx_pw_8marbledb_10PyIterator_13__iter__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__iter__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_10PyIterator_12__iter__(((struct __pyx_obj_8marbledb_PyIterator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyIterator_12__iter__(struct __pyx_obj_8marbledb_PyIterator *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0311</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Make iterator iterable in Python.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0312</span>:         <span class="k">return</span> <span class="bp">self</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_self);
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0313</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0314</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-9 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyIterator_15__next__(PyObject *__pyx_v_self); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyIterator_14__next__, "PyIterator.__next__(self)\n\nGet next value in Python iteration.");
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_8marbledb_10PyIterator_14__next__;
#endif
static PyObject *__pyx_pw_8marbledb_10PyIterator_15__next__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__next__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_10PyIterator_14__next__(((struct __pyx_obj_8marbledb_PyIterator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyIterator_14__next__(struct __pyx_obj_8marbledb_PyIterator *__pyx_v_self) {
  PyObject *__pyx_v_key = NULL;
  PyObject *__pyx_v_value = NULL;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  if (!__pyx_error_without_exception) {
    <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyIterator.__next__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  }
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_key);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_value);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0315</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get next value in Python iteration.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0316</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid</span><span class="p">():</span></pre>
<pre class='cython code score-7 '>  __pyx_t_2 = ((PyObject *)__pyx_v_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_valid, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 316, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 316, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = (!__pyx_t_4);
  if (unlikely(__pyx_t_5)) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0317</span>:             <span class="k">raise</span> <span class="ne">StopIteration</span></pre>
<pre class='cython code score-0 '>    __pyx_error_without_exception = 1;
    goto __pyx_L1_error;;
</pre><pre class="cython line score-0">&#xA0;<span class="">0318</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0319</span>:         <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">()</span></pre>
<pre class='cython code score-4 '>  __pyx_t_2 = ((PyObject *)__pyx_v_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_key, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_v_key = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0320</span>:         <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">()</span></pre>
<pre class='cython code score-4 '>  __pyx_t_2 = ((PyObject *)__pyx_v_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_value, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 320, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_v_value = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0321</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = ((PyObject *)__pyx_v_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_next, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 321, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0322</span>:         <span class="k">return</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span></pre>
<pre class='cython code score-12 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_key);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_key);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_key) != (0)) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_value);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_value) != (0)) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0323</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0324</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0325</span>: <span class="k">cdef</span><span class="w"> </span><span class="k">class</span> <span class="nf">PyQueryResult</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_8marbledb_PyQueryResult {
  PyObject_HEAD
  struct __pyx_vtabstruct_8marbledb_PyQueryResult *__pyx_vtab;
  std::unique_ptr&lt;marble::QueryResult&gt;  result;
};
/* … */
struct __pyx_vtabstruct_8marbledb_PyQueryResult {
  void (*_set_result)(struct __pyx_obj_8marbledb_PyQueryResult *, std::unique_ptr&lt;marble::QueryResult&gt;  &amp;);
};
static struct __pyx_vtabstruct_8marbledb_PyQueryResult *__pyx_vtabptr_8marbledb_PyQueryResult;
</pre><pre class="cython line score-0">&#xA0;<span class="">0326</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Python wrapper for QueryResult.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0327</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">unique_ptr</span>[<span class="kt">QueryResult</span>] <span class="nf">result</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0328</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0329</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">void</span> <span class="nf">_set_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_ptr</span><span class="p">[</span><span class="n">QueryResult</span><span class="p">]</span><span class="o">&amp;</span> <span class="n">qr</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_8marbledb_13PyQueryResult__set_result(struct __pyx_obj_8marbledb_PyQueryResult *__pyx_v_self, std::unique_ptr&lt;marble::QueryResult&gt;  &amp;__pyx_v_qr) {
/* … */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0330</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal method to take ownership of C++ QueryResult.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0331</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="n">qr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;result.swap(__pyx_v_qr);
</pre><pre class="cython line score-0">&#xA0;<span class="">0332</span>: </pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0333</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">has_next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-23 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_13PyQueryResult_1has_next(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_13PyQueryResult_has_next, "PyQueryResult.has_next(self)\n\nCheck if there are more batches.");
static PyMethodDef __pyx_mdef_8marbledb_13PyQueryResult_1has_next = {"has_next", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_13PyQueryResult_1has_next, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_13PyQueryResult_has_next};
static PyObject *__pyx_pw_8marbledb_13PyQueryResult_1has_next(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("has_next (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("has_next", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return NULL;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("has_next", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_8marbledb_13PyQueryResult_has_next(((struct __pyx_obj_8marbledb_PyQueryResult *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_13PyQueryResult_has_next(struct __pyx_obj_8marbledb_PyQueryResult *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyQueryResult.has_next", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_13PyQueryResult_1has_next, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyQueryResult_has_next, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[19]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyQueryResult, __pyx_mstate_global-&gt;__pyx_n_u_has_next, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 333, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0334</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if there are more batches.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0335</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;result.get() == NULL);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0336</span>:             <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
    __pyx_r = Py_False;
    goto __pyx_L0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0337</span>:         <span class="k">return</span> <span class="n">deref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">)</span><span class="o">.</span><span class="n">HasNext</span><span class="p">()</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>((*__pyx_v_self-&gt;result).HasNext());<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 337, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0338</span>: </pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0339</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-26 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_13PyQueryResult_3next(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_13PyQueryResult_2next, "PyQueryResult.next(self)\n\nGet next RecordBatch.");
static PyMethodDef __pyx_mdef_8marbledb_13PyQueryResult_3next = {"next", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_13PyQueryResult_3next, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_13PyQueryResult_2next};
static PyObject *__pyx_pw_8marbledb_13PyQueryResult_3next(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("next (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("next", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return NULL;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("next", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_8marbledb_13PyQueryResult_2next(((struct __pyx_obj_8marbledb_PyQueryResult *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_13PyQueryResult_2next(struct __pyx_obj_8marbledb_PyQueryResult *__pyx_v_self) {
  std::shared_ptr&lt; arrow::RecordBatch&gt;  __pyx_v_batch;
  marble::Status __pyx_v_status;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyQueryResult.next", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_13PyQueryResult_3next, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyQueryResult_next, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[20]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 339, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyQueryResult, __pyx_mstate_global-&gt;__pyx_n_u_next, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 339, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0340</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get next RecordBatch.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0341</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;result.get() == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0342</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;QueryResult not initialized&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_QueryResult_not_initialized};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0343</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0344</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">CRecordBatch</span>] <span class="nf">batch</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0345</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span><span class="w"> </span><span class="o">=</span> <span class="n">deref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">)</span><span class="o">.</span><span class="n">Next</span><span class="p">(</span><span class="o">&amp;</span><span class="n">batch</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_status = (*__pyx_v_self-&gt;result).Next((&amp;__pyx_v_batch));
</pre><pre class="cython line score-0">&#xA0;<span class="">0346</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0347</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0348</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">status</span><span class="o">.</span><span class="n">ToString</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span></pre>
<pre class='cython code score-20 '>    __pyx_t_4 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 348, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 348, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_4);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_6};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 348, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 348, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0349</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0350</span>:         <span class="k">if</span> <span class="n">batch</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_batch.get() == NULL);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0351</span>:             <span class="k">return</span> <span class="bp">None</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0352</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0353</span>:         <span class="k">return</span> <span class="n">pyarrow_wrap_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = __pyx_f_7pyarrow_3lib_pyarrow_wrap_batch(__pyx_v_batch);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0354</span>: </pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0355</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">schema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-25 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_13PyQueryResult_5schema(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_13PyQueryResult_4schema, "PyQueryResult.schema(self)\n\nGet result schema.");
static PyMethodDef __pyx_mdef_8marbledb_13PyQueryResult_5schema = {"schema", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_13PyQueryResult_5schema, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_13PyQueryResult_4schema};
static PyObject *__pyx_pw_8marbledb_13PyQueryResult_5schema(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("schema (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("schema", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return NULL;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("schema", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_8marbledb_13PyQueryResult_4schema(((struct __pyx_obj_8marbledb_PyQueryResult *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_13PyQueryResult_4schema(struct __pyx_obj_8marbledb_PyQueryResult *__pyx_v_self) {
  std::shared_ptr&lt; arrow::Schema&gt;  __pyx_v_schema;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyQueryResult.schema", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_13PyQueryResult_5schema, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyQueryResult_schema, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[21]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyQueryResult, __pyx_mstate_global-&gt;__pyx_n_u_schema, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0356</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get result schema.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0357</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;result.get() == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0358</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;QueryResult not initialized&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 358, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_QueryResult_not_initialized};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 358, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 358, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0359</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0360</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">CSchema</span>] <span class="nf">schema</span><span class="w"> </span><span class="o">=</span> <span class="n">deref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">)</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_schema = (*__pyx_v_self-&gt;result).schema();
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0361</span>:         <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_schema.get() == NULL);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0362</span>:             <span class="k">return</span> <span class="bp">None</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0363</span>:         <span class="k">return</span> <span class="n">pyarrow_wrap_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = __pyx_f_7pyarrow_3lib_pyarrow_wrap_schema(__pyx_v_schema);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0364</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0365</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">to_table</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-30 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_13PyQueryResult_7to_table(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_13PyQueryResult_6to_table, "PyQueryResult.to_table(self)\n\nConvert all batches to a single Arrow Table.");
static PyMethodDef __pyx_mdef_8marbledb_13PyQueryResult_7to_table = {"to_table", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_13PyQueryResult_7to_table, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_13PyQueryResult_6to_table};
static PyObject *__pyx_pw_8marbledb_13PyQueryResult_7to_table(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_table (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("to_table", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return NULL;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("to_table", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_8marbledb_13PyQueryResult_6to_table(((struct __pyx_obj_8marbledb_PyQueryResult *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_13PyQueryResult_6to_table(struct __pyx_obj_8marbledb_PyQueryResult *__pyx_v_self) {
  PyObject *__pyx_v_batches = NULL;
  PyObject *__pyx_v_batch = NULL;
  PyObject *__pyx_v_schema = NULL;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyQueryResult.to_table", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_batches);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_batch);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_schema);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_13PyQueryResult_7to_table, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyQueryResult_to_table, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[22]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 365, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyQueryResult, __pyx_mstate_global-&gt;__pyx_n_u_to_table, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 365, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0366</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert all batches to a single Arrow Table.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0367</span>:         <span class="n">batches</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_batches = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0368</span>:         <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_next</span><span class="p">():</span></pre>
<pre class='cython code score-7 '>  while (1) {
    __pyx_t_2 = ((PyObject *)__pyx_v_self);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    __pyx_t_3 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_has_next, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 368, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 368, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (!__pyx_t_4) break;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0369</span>:             <span class="n">batch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>    __pyx_t_2 = ((PyObject *)__pyx_v_self);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    __pyx_t_3 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_next, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_batch, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0370</span>:             <span class="k">if</span> <span class="n">batch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = (__pyx_v_batch != Py_None);
    if (__pyx_t_4) {
/* … */
    }
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0371</span>:                 <span class="n">batches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_batches, __pyx_v_batch);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 371, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0372</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0373</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">batches</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  {
    Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_v_batches);
    if (unlikely(((!CYTHON_ASSUME_SAFE_SIZE) &amp;&amp; __pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 373, __pyx_L1_error)</span>
    __pyx_t_4 = (__pyx_temp != 0);
  }

  __pyx_t_6 = (!__pyx_t_4);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0374</span>:             <span class="c"># Return empty table with schema</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0375</span>:             <span class="n">schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span></pre>
<pre class='cython code score-4 '>    __pyx_t_2 = ((PyObject *)__pyx_v_self);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    __pyx_t_3 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_schema, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 375, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    __pyx_v_schema = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0376</span>:             <span class="k">if</span> <span class="n">schema</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = (__pyx_v_schema == Py_None);
    if (unlikely(__pyx_t_6)) {
/* … */
    }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0377</span>:                 <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;No schema available&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>      __pyx_t_2 = NULL;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 377, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_3 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        assert(__pyx_t_2);
        PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, __pyx__function);
        __pyx_t_3 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_mstate_global-&gt;__pyx_kp_u_No_schema_available};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0378</span>:             <span class="k">return</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_batches</span><span class="p">([],</span> <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_pa);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_Table);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_7 = __pyx_t_8;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
    __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = 0;
    {
      PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_7, __pyx_t_2};
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_schema, __pyx_v_schema, __pyx_t_9, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 378, __pyx_L1_error)</span>
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_VectorcallMethod_CallFromBuilder</span>(__pyx_mstate_global-&gt;__pyx_n_u_from_batches, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 378, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0379</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0380</span>:         <span class="k">return</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_batches</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_mstate_global-&gt;__pyx_n_u_pa);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 380, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_mstate_global-&gt;__pyx_n_u_Table);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 380, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_8 = __pyx_t_2;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
  __pyx_t_3 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_batches};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_from_batches, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 380, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0381</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0382</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_13PyQueryResult_9__iter__(PyObject *__pyx_v_self); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_13PyQueryResult_8__iter__, "PyQueryResult.__iter__(self)\n\nMake result iterable.");
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_8marbledb_13PyQueryResult_8__iter__;
#endif
static PyObject *__pyx_pw_8marbledb_13PyQueryResult_9__iter__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__iter__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_13PyQueryResult_8__iter__(((struct __pyx_obj_8marbledb_PyQueryResult *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_13PyQueryResult_8__iter__(struct __pyx_obj_8marbledb_PyQueryResult *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0383</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Make result iterable.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0384</span>:         <span class="k">return</span> <span class="bp">self</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_self);
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0385</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0386</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-7 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_13PyQueryResult_11__next__(PyObject *__pyx_v_self); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_13PyQueryResult_10__next__, "PyQueryResult.__next__(self)\n\nGet next batch in Python iteration.");
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_8marbledb_13PyQueryResult_10__next__;
#endif
static PyObject *__pyx_pw_8marbledb_13PyQueryResult_11__next__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__next__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_8marbledb_13PyQueryResult_10__next__(((struct __pyx_obj_8marbledb_PyQueryResult *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_13PyQueryResult_10__next__(struct __pyx_obj_8marbledb_PyQueryResult *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  if (!__pyx_error_without_exception) {
    <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyQueryResult.__next__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  }
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0387</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get next batch in Python iteration.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0388</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_next</span><span class="p">():</span></pre>
<pre class='cython code score-7 '>  __pyx_t_2 = ((PyObject *)__pyx_v_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_has_next, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = (!__pyx_t_4);
  if (unlikely(__pyx_t_5)) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0389</span>:             <span class="k">raise</span> <span class="ne">StopIteration</span></pre>
<pre class='cython code score-0 '>    __pyx_error_without_exception = 1;
    goto __pyx_L1_error;;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0390</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = ((PyObject *)__pyx_v_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_next, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 390, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0391</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0392</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0393</span>: <span class="k">cdef</span><span class="w"> </span><span class="k">class</span> <span class="nf">PyMarbleDB</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_8marbledb_PyMarbleDB {
  PyObject_HEAD
  marble::MarbleDB *db;
};


</pre><pre class="cython line score-0">&#xA0;<span class="">0394</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Python wrapper for MarbleDB database.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0395</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">CppMarbleDB</span>* <span class="nf">db</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0396</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0397</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-14 '>/* Python wrapper */
static int __pyx_pw_8marbledb_10PyMarbleDB_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_8marbledb_10PyMarbleDB_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return -1;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_VARARGS</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return -1;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("__cinit__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB___cinit__(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_8marbledb_10PyMarbleDB___cinit__(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0398</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;db = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0399</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0400</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__dealloc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>/* Python wrapper */
static void __pyx_pw_8marbledb_10PyMarbleDB_3__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_8marbledb_10PyMarbleDB_3__dealloc__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__ (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_pf_8marbledb_10PyMarbleDB_2__dealloc__(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

static void __pyx_pf_8marbledb_10PyMarbleDB_2__dealloc__(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self) {
/* … */
  /* function exit code */
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0401</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">!=</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;db != NULL);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0402</span>:             <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span></pre>
<pre class='cython code score-0 '>    delete __pyx_v_self-&gt;db;
</pre><pre class="cython line score-0">&#xA0;<span class="">0403</span>: </pre>
<pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0404</span>:     <span class="nd">@staticmethod</span></pre>
<pre class='cython code score-48 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_5open(CYTHON_UNUSED PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyMarbleDB_4open, "PyMarbleDB.open(PyDBOptions options, column_families=None)\n\nOpen a MarbleDB database.\n\nArgs:\n    options: PyDBOptions instance with database configuration\n    column_families: Optional (ignored - use create_column_family after opening)\n\nReturns:\n    PyMarbleDB instance");
static PyMethodDef __pyx_mdef_8marbledb_10PyMarbleDB_5open = {"open", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyMarbleDB_5open, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyMarbleDB_4open};
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_5open(CYTHON_UNUSED PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  struct __pyx_obj_8marbledb_PyDBOptions *__pyx_v_options = 0;
  CYTHON_UNUSED PyObject *__pyx_v_column_families = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("open (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_options,&amp;__pyx_mstate_global-&gt;__pyx_n_u_column_families,0};
  PyObject* values[2] = {0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "open", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L3_error)</span>
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyMarbleDB_4open(struct __pyx_obj_8marbledb_PyDBOptions *__pyx_v_options, CYTHON_UNUSED PyObject *__pyx_v_column_families) {
  struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_db = 0;
  std::unique_ptr&lt;marble::MarbleDB&gt;  __pyx_v_db_ptr;
  marble::Status __pyx_v_status;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.open", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_db);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyMarbleDB_5open, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB_open, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[25]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 404, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_tuple[0]);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_open, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_builtin_staticmethod);
  __pyx_t_2 = __pyx_builtin_staticmethod; 
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_4, (PyObject*)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_open);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 404, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  }
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_open, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_mstate_global-&gt;__pyx_tuple[0] = <span class='py_c_api'>PyTuple_Pack</span>(1, Py_None); if (unlikely(!__pyx_mstate_global-&gt;__pyx_tuple[0])) <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[0]);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[0]);
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0405</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">open</span><span class="p">(</span><span class="n">PyDBOptions</span> <span class="n">options</span><span class="p">,</span> <span class="n">column_families</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-16 '>      if (!values[1]) values[1] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)Py_None));
      for (Py_ssize_t i = __pyx_nargs; i &lt; 1; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("open", 0, 1, 2, i); <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L3_error)</span> }
      }
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L3_error)</span>
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[1]) values[1] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)Py_None));
    }
    __pyx_v_options = ((struct __pyx_obj_8marbledb_PyDBOptions *)values[0]);
    __pyx_v_column_families = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("open", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 404, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.open", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_options), __pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyDBOptions, 1, "options", 0))) <span class='error_goto'>__PYX_ERR(0, 405, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB_4open(__pyx_v_options, __pyx_v_column_families);
</pre><pre class="cython line score-0">&#xA0;<span class="">0406</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0407</span>: <span class="sd">        Open a MarbleDB database.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0408</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0409</span>: <span class="sd">        Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0410</span>: <span class="sd">            options: PyDBOptions instance with database configuration</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0411</span>: <span class="sd">            column_families: Optional (ignored - use create_column_family after opening)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0412</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0413</span>: <span class="sd">        Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0414</span>: <span class="sd">            PyMarbleDB instance</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0415</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0416</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">PyMarbleDB</span> <span class="nf">db</span><span class="w"> </span><span class="o">=</span> <span class="n">PyMarbleDB</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB);
  __pyx_t_3 = ((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB); 
  __pyx_t_4 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_4, (1-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 416, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_t_1);
  }
  __pyx_v_db = ((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0417</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">unique_ptr</span>[<span class="kt">CppMarbleDB</span>] <span class="nf">db_ptr</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0418</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0419</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0420</span>: <span class="w">        </span><span class="c"># Use the simpler OpenDatabase API</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0421</span>:         <span class="n">status</span> <span class="o">=</span> <span class="n">CppOpenDatabase</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">db_path</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">db_ptr</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_options), __pyx_mstate_global-&gt;__pyx_n_u_db_path);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 421, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_t_2;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_4 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_utf_8};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_encode, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 421, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_t_5 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_1);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 421, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_status = marble::OpenDatabase(__pyx_t_5, (&amp;__pyx_v_db_ptr));
</pre><pre class="cython line score-0">&#xA0;<span class="">0422</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0423</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_6)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0424</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Failed to open database: {status.ToString().decode(&#39;utf-8&#39;)}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>    __pyx_t_2 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 424, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 424, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_Failed_to_open_database, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 424, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_4 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_2);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_4 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_8};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 424, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 424, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0425</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0426</span>:         <span class="n">db</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db_ptr</span><span class="o">.</span><span class="n">release</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_db-&gt;db = __pyx_v_db_ptr.release();
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0427</span>:         <span class="k">return</span> <span class="n">db</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_db);
  __pyx_r = ((PyObject *)__pyx_v_db);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0428</span>: </pre>
<pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0429</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">create_column_family</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">name</span><span class="p">,</span> <span class="n">PyColumnFamilyOptions</span> <span class="n">options</span><span class="p">):</span></pre>
<pre class='cython code score-44 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_7create_column_family(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyMarbleDB_6create_column_family, "PyMarbleDB.create_column_family(self, str name, PyColumnFamilyOptions options)\n\nCreate a new column family.\n\nArgs:\n    name: Column family name\n    options: PyColumnFamilyOptions instance\n\nReturns:\n    None (handle is managed internally)");
static PyMethodDef __pyx_mdef_8marbledb_10PyMarbleDB_7create_column_family = {"create_column_family", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyMarbleDB_7create_column_family, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyMarbleDB_6create_column_family};
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_7create_column_family(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_name = 0;
  struct __pyx_obj_8marbledb_PyColumnFamilyOptions *__pyx_v_options = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("create_column_family (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_name,&amp;__pyx_mstate_global-&gt;__pyx_n_u_options,0};
  PyObject* values[2] = {0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 429, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 429, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 429, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "create_column_family", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 429, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 2; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("create_column_family", 1, 2, 2, i); <span class='error_goto'>__PYX_ERR(0, 429, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 429, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 429, __pyx_L3_error)</span>
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_options = ((struct __pyx_obj_8marbledb_PyColumnFamilyOptions *)values[1]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("create_column_family", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 429, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.create_column_family", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyUnicode_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 429, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_options), __pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyColumnFamilyOptions, 1, "options", 0))) <span class='error_goto'>__PYX_ERR(0, 429, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB_6create_column_family(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self), __pyx_v_name, __pyx_v_options);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyMarbleDB_6create_column_family(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self, PyObject *__pyx_v_name, struct __pyx_obj_8marbledb_PyColumnFamilyOptions *__pyx_v_options) {
  marble::ColumnFamilyHandle *__pyx_v_handle;
  marble::ColumnFamilyDescriptor *__pyx_v_descriptor;
  marble::Status __pyx_v_status;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.create_column_family", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyMarbleDB_7create_column_family, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB_create_column_family, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[26]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 429, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_create_column_family, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 429, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0430</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0431</span>: <span class="sd">        Create a new column family.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0432</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0433</span>: <span class="sd">        Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0434</span>: <span class="sd">            name: Column family name</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0435</span>: <span class="sd">            options: PyColumnFamilyOptions instance</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0436</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0437</span>: <span class="sd">        Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0438</span>: <span class="sd">            None (handle is managed internally)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0439</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0440</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;db == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0441</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Database not opened&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 441, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Database_not_opened};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0442</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0443</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">ColumnFamilyHandle</span>* <span class="nf">handle</span><span class="w"> </span><span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_handle = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0444</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">ColumnFamilyDescriptor</span>* <span class="nf">descriptor</span><span class="w"> </span><span class="o">=</span> <span class="n">new</span> <span class="n">ColumnFamilyDescriptor</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_descriptor = new marble::ColumnFamilyDescriptor(__pyx_t_6, (*__pyx_v_options-&gt;opts));
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0445</span>:             <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">),</span></pre>
<pre class='cython code score-6 '>  if (unlikely(__pyx_v_name == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "encode");
    <span class='error_goto'>__PYX_ERR(0, 445, __pyx_L1_error)</span>
  }
  __pyx_t_2 = PyUnicode_AsUTF8String(__pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 445, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_2);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 445, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0446</span>:             <span class="n">deref</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">opts</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0447</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0448</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0449</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span><span class="w"> </span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">CreateColumnFamily</span><span class="p">(</span><span class="n">deref</span><span class="p">(</span><span class="n">descriptor</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">handle</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_status = __pyx_v_self-&gt;db-&gt;CreateColumnFamily((*__pyx_v_descriptor), (&amp;__pyx_v_handle));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0450</span>:         <span class="k">del</span> <span class="n">descriptor</span></pre>
<pre class='cython code score-0 '>  delete __pyx_v_descriptor;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0451</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0452</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Failed to create column family: {status.ToString().decode(&#39;utf-8&#39;)}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>    __pyx_t_4 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_Failed_to_create_column_family, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_4);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_8};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 452, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 452, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0453</span>: </pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0454</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">create_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">name</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">PyTableCapabilities</span> <span class="n">capabilities</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-54 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_9create_table(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyMarbleDB_8create_table, "PyMarbleDB.create_table(self, str name, schema, PyTableCapabilities capabilities=None)\n\nCreate a table with optional temporal/MVCC capabilities.\n\nArgs:\n    name: Table name\n    schema: pyarrow.Schema defining the table columns\n    capabilities: Optional PyTableCapabilities for temporal features\n\nExample:\n    # Create a regular table\n    schema = pa.schema([pa.field(\"id\", pa.string()), pa.field(\"value\", pa.float64())])\n    db.create_table(\"simple\", schema)\n\n    # Create a bitemporal table\n    caps = PyTableCapabilities.bitemporal(max_versions=10)\n    db.create_table(\"employees\", schema, caps)");
static PyMethodDef __pyx_mdef_8marbledb_10PyMarbleDB_9create_table = {"create_table", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyMarbleDB_9create_table, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyMarbleDB_8create_table};
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_9create_table(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_schema = 0;
  struct __pyx_obj_8marbledb_PyTableCapabilities *__pyx_v_capabilities = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("create_table (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_name,&amp;__pyx_mstate_global-&gt;__pyx_n_u_schema,&amp;__pyx_mstate_global-&gt;__pyx_n_u_capabilities,0};
  PyObject* values[3] = {0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "create_table", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L3_error)</span>
      if (!values[2]) values[2] = <span class='pyx_c_api'>__Pyx_NewRef</span>((PyObject *)((struct __pyx_obj_8marbledb_PyTableCapabilities *)Py_None));
      for (Py_ssize_t i = __pyx_nargs; i &lt; 2; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("create_table", 0, 2, 3, i); <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L3_error)</span> }
      }
    } else {
      switch (__pyx_nargs) {
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L3_error)</span>
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L3_error)</span>
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[2]) values[2] = <span class='pyx_c_api'>__Pyx_NewRef</span>((PyObject *)((struct __pyx_obj_8marbledb_PyTableCapabilities *)Py_None));
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_schema = values[1];
    __pyx_v_capabilities = ((struct __pyx_obj_8marbledb_PyTableCapabilities *)values[2]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("create_table", 0, 2, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.create_table", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyUnicode_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_capabilities), __pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyTableCapabilities, 1, "capabilities", 0))) <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB_8create_table(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self), __pyx_v_name, __pyx_v_schema, __pyx_v_capabilities);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyMarbleDB_8create_table(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self, PyObject *__pyx_v_name, PyObject *__pyx_v_schema, struct __pyx_obj_8marbledb_PyTableCapabilities *__pyx_v_capabilities) {
  std::shared_ptr&lt; arrow::Schema&gt;  __pyx_v_c_schema;
  marble::TableSchema __pyx_v_table_schema;
  marble::TableCapabilities __pyx_v_caps;
  marble::Status __pyx_v_status;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.create_table", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyMarbleDB_9create_table, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB_create_table, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[27]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 454, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_tuple[0]);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_create_table, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0455</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0456</span>: <span class="sd">        Create a table with optional temporal/MVCC capabilities.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0457</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0458</span>: <span class="sd">        Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0459</span>: <span class="sd">            name: Table name</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0460</span>: <span class="sd">            schema: pyarrow.Schema defining the table columns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0461</span>: <span class="sd">            capabilities: Optional PyTableCapabilities for temporal features</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0462</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0463</span>: <span class="sd">        Example:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0464</span>: <span class="sd">            # Create a regular table</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0465</span>: <span class="sd">            schema = pa.schema([pa.field(&quot;id&quot;, pa.string()), pa.field(&quot;value&quot;, pa.float64())])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0466</span>: <span class="sd">            db.create_table(&quot;simple&quot;, schema)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0467</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0468</span>: <span class="sd">            # Create a bitemporal table</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0469</span>: <span class="sd">            caps = PyTableCapabilities.bitemporal(max_versions=10)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0470</span>: <span class="sd">            db.create_table(&quot;employees&quot;, schema, caps)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0471</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0472</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;db == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0473</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Database not opened&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 473, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Database_not_opened};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 473, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 473, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0474</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0475</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">CSchema</span>] <span class="nf">c_schema</span><span class="w"> </span><span class="o">=</span> <span class="n">pyarrow_unwrap_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_f_7pyarrow_3lib_pyarrow_unwrap_schema(__pyx_v_schema);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 475, __pyx_L1_error)</span>
  __pyx_v_c_schema = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_6);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0476</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">TableSchema</span> <span class="nf">table_schema</span><span class="w"> </span><span class="o">=</span> <span class="n">TableSchema</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">),</span> <span class="n">c_schema</span><span class="p">)</span></pre>
<pre class='cython code score-6 '>  if (unlikely(__pyx_v_name == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "encode");
    <span class='error_goto'>__PYX_ERR(0, 476, __pyx_L1_error)</span>
  }
  __pyx_t_2 = PyUnicode_AsUTF8String(__pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 476, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_2);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 476, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_table_schema = marble::TableSchema(__pyx_t_7, __pyx_v_c_schema);
</pre><pre class="cython line score-0">&#xA0;<span class="">0477</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">TableCapabilities</span> <span class="nf">caps</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0478</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0479</span>:         <span class="k">if</span> <span class="n">capabilities</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((PyObject *)__pyx_v_capabilities) != Py_None);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0480</span>:             <span class="n">caps</span> <span class="o">=</span> <span class="n">deref</span><span class="p">(</span><span class="n">capabilities</span><span class="o">.</span><span class="n">caps</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_caps = (*__pyx_v_capabilities-&gt;caps);
</pre><pre class="cython line score-0">&#xA0;<span class="">0481</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0482</span>:             <span class="n">caps</span> <span class="o">=</span> <span class="n">TableCapabilities</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_caps = marble::TableCapabilities();
  }
  __pyx_L4:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0483</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0484</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span><span class="w"> </span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">CreateTable</span><span class="p">(</span><span class="n">table_schema</span><span class="p">,</span> <span class="n">caps</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_status = __pyx_v_self-&gt;db-&gt;CreateTable(__pyx_v_table_schema, __pyx_v_caps);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0485</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0486</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Failed to create table: {status.ToString().decode(&#39;utf-8&#39;)}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>    __pyx_t_4 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_8 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_Failed_to_create_table, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_4);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_9};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 486, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 486, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0487</span>: </pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0488</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">insert_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">cf_name</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span></pre>
<pre class='cython code score-42 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_11insert_batch(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyMarbleDB_10insert_batch, "PyMarbleDB.insert_batch(self, str cf_name, batch)\n\nInsert a RecordBatch into the specified column family.\n\nArgs:\n    cf_name: Column family name\n    batch: pyarrow.RecordBatch to insert\n\nReturns:\n    None");
static PyMethodDef __pyx_mdef_8marbledb_10PyMarbleDB_11insert_batch = {"insert_batch", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyMarbleDB_11insert_batch, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyMarbleDB_10insert_batch};
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_11insert_batch(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_cf_name = 0;
  PyObject *__pyx_v_batch = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("insert_batch (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_cf_name,&amp;__pyx_mstate_global-&gt;__pyx_n_u_batch,0};
  PyObject* values[2] = {0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 488, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 488, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 488, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "insert_batch", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 488, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 2; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("insert_batch", 1, 2, 2, i); <span class='error_goto'>__PYX_ERR(0, 488, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 488, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 488, __pyx_L3_error)</span>
    }
    __pyx_v_cf_name = ((PyObject*)values[0]);
    __pyx_v_batch = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("insert_batch", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 488, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.insert_batch", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_cf_name), (&amp;PyUnicode_Type), 1, "cf_name", 1))) <span class='error_goto'>__PYX_ERR(0, 488, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB_10insert_batch(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self), __pyx_v_cf_name, __pyx_v_batch);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyMarbleDB_10insert_batch(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self, PyObject *__pyx_v_cf_name, PyObject *__pyx_v_batch) {
  std::shared_ptr&lt; arrow::RecordBatch&gt;  __pyx_v_c_batch;
  marble::Status __pyx_v_status;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.insert_batch", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyMarbleDB_11insert_batch, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB_insert_batch, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[28]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_insert_batch, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 488, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0489</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0490</span>: <span class="sd">        Insert a RecordBatch into the specified column family.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0491</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0492</span>: <span class="sd">        Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0493</span>: <span class="sd">            cf_name: Column family name</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0494</span>: <span class="sd">            batch: pyarrow.RecordBatch to insert</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0495</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0496</span>: <span class="sd">        Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0497</span>: <span class="sd">            None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0498</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0499</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;db == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0500</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Database not opened&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 500, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Database_not_opened};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 500, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 500, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0501</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0502</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">CRecordBatch</span>] <span class="nf">c_batch</span><span class="w"> </span><span class="o">=</span> <span class="n">pyarrow_unwrap_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_f_7pyarrow_3lib_pyarrow_unwrap_batch(__pyx_v_batch);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 502, __pyx_L1_error)</span>
  __pyx_v_c_batch = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_6);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0503</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span><span class="w"> </span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">InsertBatch</span><span class="p">(</span><span class="n">cf_name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">),</span> <span class="n">c_batch</span><span class="p">)</span></pre>
<pre class='cython code score-6 '>  if (unlikely(__pyx_v_cf_name == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "encode");
    <span class='error_goto'>__PYX_ERR(0, 503, __pyx_L1_error)</span>
  }
  __pyx_t_2 = PyUnicode_AsUTF8String(__pyx_v_cf_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_2);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_status = __pyx_v_self-&gt;db-&gt;InsertBatch(__pyx_t_7, __pyx_v_c_batch);
</pre><pre class="cython line score-0">&#xA0;<span class="">0504</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0505</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0506</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Failed to insert batch: {status.ToString().decode(&#39;utf-8&#39;)}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>    __pyx_t_4 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_8 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 506, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_Failed_to_insert_batch, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 506, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_4);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_9};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 506, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 506, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0507</span>: </pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0508</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">scan_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">cf_name</span><span class="p">):</span></pre>
<pre class='cython code score-38 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_13scan_table(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyMarbleDB_12scan_table, "PyMarbleDB.scan_table(self, str cf_name)\n\nScan entire column family.\n\nArgs:\n    cf_name: Column family name\n\nReturns:\n    PyQueryResult instance");
static PyMethodDef __pyx_mdef_8marbledb_10PyMarbleDB_13scan_table = {"scan_table", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyMarbleDB_13scan_table, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyMarbleDB_12scan_table};
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_13scan_table(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_cf_name = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scan_table (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_cf_name,0};
  PyObject* values[1] = {0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 508, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 508, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "scan_table", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 508, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 1; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("scan_table", 1, 1, 1, i); <span class='error_goto'>__PYX_ERR(0, 508, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 508, __pyx_L3_error)</span>
    }
    __pyx_v_cf_name = ((PyObject*)values[0]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("scan_table", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 508, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.scan_table", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_cf_name), (&amp;PyUnicode_Type), 1, "cf_name", 1))) <span class='error_goto'>__PYX_ERR(0, 508, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB_12scan_table(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self), __pyx_v_cf_name);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyMarbleDB_12scan_table(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self, PyObject *__pyx_v_cf_name) {
  std::unique_ptr&lt;marble::QueryResult&gt;  __pyx_v_result;
  marble::Status __pyx_v_status;
  struct __pyx_obj_8marbledb_PyQueryResult *__pyx_v_py_result = NULL;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.scan_table", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_py_result);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyMarbleDB_13scan_table, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB_scan_table, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[29]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 508, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_scan_table, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 508, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0509</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0510</span>: <span class="sd">        Scan entire column family.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0511</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0512</span>: <span class="sd">        Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0513</span>: <span class="sd">            cf_name: Column family name</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0514</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0515</span>: <span class="sd">        Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0516</span>: <span class="sd">            PyQueryResult instance</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0517</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0518</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;db == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0519</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Database not opened&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 519, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Database_not_opened};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 519, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 519, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0520</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0521</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">unique_ptr</span>[<span class="kt">QueryResult</span>] <span class="nf">result</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0522</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span><span class="w"> </span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ScanTable</span><span class="p">(</span><span class="n">cf_name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">result</span><span class="p">)</span></pre>
<pre class='cython code score-6 '>  if (unlikely(__pyx_v_cf_name == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "encode");
    <span class='error_goto'>__PYX_ERR(0, 522, __pyx_L1_error)</span>
  }
  __pyx_t_2 = PyUnicode_AsUTF8String(__pyx_v_cf_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 522, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_2);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 522, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_status = __pyx_v_self-&gt;db-&gt;ScanTable(__pyx_t_6, (&amp;__pyx_v_result));
</pre><pre class="cython line score-0">&#xA0;<span class="">0523</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0524</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0525</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Failed to scan table: {status.ToString().decode(&#39;utf-8&#39;)}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>    __pyx_t_4 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 525, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 525, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_Failed_to_scan_table, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 525, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_4);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_8};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0526</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0527</span>:         <span class="n">py_result</span> <span class="o">=</span> <span class="n">PyQueryResult</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyQueryResult);
  __pyx_t_8 = ((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyQueryResult); 
  __pyx_t_5 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 527, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_t_2);
  }
  __pyx_v_py_result = ((struct __pyx_obj_8marbledb_PyQueryResult *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0528</span>:         <span class="n">py_result</span><span class="o">.</span><span class="n">_set_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_8marbledb_PyQueryResult *)__pyx_v_py_result-&gt;__pyx_vtab)-&gt;_set_result(__pyx_v_py_result, __pyx_v_result);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 528, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0529</span>:         <span class="k">return</span> <span class="n">py_result</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_py_result);
  __pyx_r = ((PyObject *)__pyx_v_py_result);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0530</span>: </pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0531</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">new_iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">cf_name</span><span class="p">,</span> <span class="n">PyTripleKey</span> <span class="n">start_key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">PyTripleKey</span> <span class="n">end_key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span></pre>
<pre class='cython code score-70 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_15new_iterator(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyMarbleDB_14new_iterator, "PyMarbleDB.new_iterator(self, str cf_name, PyTripleKey start_key=None, PyTripleKey end_key=None, bool start_inclusive=True, bool end_inclusive=False)\n\nCreate an iterator for range scanning.\n\nArgs:\n    cf_name: Column family name\n    start_key: Optional start key (None for beginning)\n    end_key: Optional end key (None for end)\n    start_inclusive: Include start key in range\n    end_inclusive: Include end key in range\n\nReturns:\n    PyIterator instance");
static PyMethodDef __pyx_mdef_8marbledb_10PyMarbleDB_15new_iterator = {"new_iterator", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyMarbleDB_15new_iterator, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyMarbleDB_14new_iterator};
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_15new_iterator(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_cf_name = 0;
  CYTHON_UNUSED struct __pyx_obj_8marbledb_PyTripleKey *__pyx_v_start_key = 0;
  CYTHON_UNUSED struct __pyx_obj_8marbledb_PyTripleKey *__pyx_v_end_key = 0;
  CYTHON_UNUSED bool __pyx_v_start_inclusive;
  CYTHON_UNUSED bool __pyx_v_end_inclusive;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("new_iterator (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_cf_name,&amp;__pyx_mstate_global-&gt;__pyx_n_u_start_key,&amp;__pyx_mstate_global-&gt;__pyx_n_u_end_key,&amp;__pyx_mstate_global-&gt;__pyx_n_u_start_inclusive,&amp;__pyx_mstate_global-&gt;__pyx_n_u_end_inclusive,0};
  PyObject* values[5] = {0,0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "new_iterator", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L3_error)</span>
      if (!values[1]) values[1] = <span class='pyx_c_api'>__Pyx_NewRef</span>((PyObject *)((struct __pyx_obj_8marbledb_PyTripleKey *)Py_None));
      if (!values[2]) values[2] = <span class='pyx_c_api'>__Pyx_NewRef</span>((PyObject *)((struct __pyx_obj_8marbledb_PyTripleKey *)Py_None));
      for (Py_ssize_t i = __pyx_nargs; i &lt; 1; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("new_iterator", 0, 1, 5, i); <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L3_error)</span> }
      }
    } else {
      switch (__pyx_nargs) {
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L3_error)</span>
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[1]) values[1] = <span class='pyx_c_api'>__Pyx_NewRef</span>((PyObject *)((struct __pyx_obj_8marbledb_PyTripleKey *)Py_None));
      if (!values[2]) values[2] = <span class='pyx_c_api'>__Pyx_NewRef</span>((PyObject *)((struct __pyx_obj_8marbledb_PyTripleKey *)Py_None));
    }
    __pyx_v_cf_name = ((PyObject*)values[0]);
    __pyx_v_start_key = ((struct __pyx_obj_8marbledb_PyTripleKey *)values[1]);
    __pyx_v_end_key = ((struct __pyx_obj_8marbledb_PyTripleKey *)values[2]);
    if (values[3]) {
      __pyx_v_start_inclusive = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(values[3]); if (unlikely((__pyx_v_start_inclusive == ((bool)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 532, __pyx_L3_error)</span>
    } else {
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyMarbleDB_14new_iterator(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self, PyObject *__pyx_v_cf_name, CYTHON_UNUSED struct __pyx_obj_8marbledb_PyTripleKey *__pyx_v_start_key, CYTHON_UNUSED struct __pyx_obj_8marbledb_PyTripleKey *__pyx_v_end_key, CYTHON_UNUSED bool __pyx_v_start_inclusive, CYTHON_UNUSED bool __pyx_v_end_inclusive) {
  marble::ReadOptions __pyx_v_read_opts;
  std::unique_ptr&lt;marble::Iterator&gt;  __pyx_v_iterator;
  marble::Status __pyx_v_status;
  struct __pyx_obj_8marbledb_PyIterator *__pyx_v_py_iterator = NULL;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.new_iterator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_py_iterator);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyMarbleDB_15new_iterator, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB_new_iterator, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[30]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_tuple[1]);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_new_iterator, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_mstate_global-&gt;__pyx_tuple[1] = <span class='py_c_api'>PyTuple_Pack</span>(4, Py_None, Py_None, Py_True, Py_False); if (unlikely(!__pyx_mstate_global-&gt;__pyx_tuple[1])) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[1]);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[1]);
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0532</span>:                      <span class="nb">bool</span> <span class="n">start_inclusive</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="nb">bool</span> <span class="n">end_inclusive</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span></pre>
<pre class='cython code score-17 '>      __pyx_v_start_inclusive = ((bool)1);
    }
    if (values[4]) {
      __pyx_v_end_inclusive = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(values[4]); if (unlikely((__pyx_v_end_inclusive == ((bool)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 532, __pyx_L3_error)</span>
    } else {
      __pyx_v_end_inclusive = ((bool)0);
    }
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("new_iterator", 0, 1, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.new_iterator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_cf_name), (&amp;PyUnicode_Type), 1, "cf_name", 1))) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_start_key), __pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyTripleKey, 1, "start_key", 0))) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_end_key), __pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyTripleKey, 1, "end_key", 0))) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB_14new_iterator(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self), __pyx_v_cf_name, __pyx_v_start_key, __pyx_v_end_key, __pyx_v_start_inclusive, __pyx_v_end_inclusive);
</pre><pre class="cython line score-0">&#xA0;<span class="">0533</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0534</span>: <span class="sd">        Create an iterator for range scanning.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0535</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0536</span>: <span class="sd">        Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0537</span>: <span class="sd">            cf_name: Column family name</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0538</span>: <span class="sd">            start_key: Optional start key (None for beginning)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0539</span>: <span class="sd">            end_key: Optional end key (None for end)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0540</span>: <span class="sd">            start_inclusive: Include start key in range</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0541</span>: <span class="sd">            end_inclusive: Include end key in range</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0542</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0543</span>: <span class="sd">        Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0544</span>: <span class="sd">            PyIterator instance</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0545</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0546</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;db == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0547</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Database not opened&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 547, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Database_not_opened};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0548</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0549</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">ReadOptions</span> <span class="nf">read_opts</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0550</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0551</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">unique_ptr</span>[<span class="kt">Iterator</span>] <span class="nf">iterator</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0552</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span><span class="w"> </span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">NewIterator</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_status = __pyx_v_self-&gt;db-&gt;NewIterator(__pyx_t_6, __pyx_v_read_opts, marble::KeyRange::All(), (&amp;__pyx_v_iterator));
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0553</span>:             <span class="n">cf_name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">),</span></pre>
<pre class='cython code score-6 '>  if (unlikely(__pyx_v_cf_name == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "encode");
    <span class='error_goto'>__PYX_ERR(0, 553, __pyx_L1_error)</span>
  }
  __pyx_t_2 = PyUnicode_AsUTF8String(__pyx_v_cf_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 553, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_2);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 553, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0554</span>:             <span class="n">read_opts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0555</span>:             <span class="n">KeyRange</span><span class="o">.</span><span class="n">All</span><span class="p">(),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0556</span>:             <span class="o">&amp;</span><span class="n">iterator</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0557</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0558</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0559</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0560</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Failed to create iterator: {status.ToString().decode(&#39;utf-8&#39;)}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>    __pyx_t_4 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_Failed_to_create_iterator, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_4);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_8};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0561</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0562</span>:         <span class="n">py_iterator</span> <span class="o">=</span> <span class="n">PyIterator</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyIterator);
  __pyx_t_8 = ((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyIterator); 
  __pyx_t_5 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 562, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_t_2);
  }
  __pyx_v_py_iterator = ((struct __pyx_obj_8marbledb_PyIterator *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0563</span>:         <span class="n">py_iterator</span><span class="o">.</span><span class="n">_set_iterator</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_8marbledb_PyIterator *)__pyx_v_py_iterator-&gt;__pyx_vtab)-&gt;_set_iterator(__pyx_v_py_iterator, __pyx_v_iterator);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 563, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0564</span>:         <span class="k">return</span> <span class="n">py_iterator</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_py_iterator);
  __pyx_r = ((PyObject *)__pyx_v_py_iterator);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0565</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0566</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-28 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_17flush(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyMarbleDB_16flush, "PyMarbleDB.flush(self)\n\nFlush memtables to disk.");
static PyMethodDef __pyx_mdef_8marbledb_10PyMarbleDB_17flush = {"flush", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyMarbleDB_17flush, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyMarbleDB_16flush};
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_17flush(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("flush (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flush", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return NULL;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("flush", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB_16flush(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyMarbleDB_16flush(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self) {
  marble::Status __pyx_v_status;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.flush", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyMarbleDB_17flush, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB_flush, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[31]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_flush, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0567</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Flush memtables to disk.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0568</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;db == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0569</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Database not opened&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Database_not_opened};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0570</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0571</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span><span class="w"> </span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Flush</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_status = __pyx_v_self-&gt;db-&gt;Flush();
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0572</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0573</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Flush failed: {status.ToString().decode(&#39;utf-8&#39;)}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>    __pyx_t_4 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_Flush_failed, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_4);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_7};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 573, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 573, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0574</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0575</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">compact_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-28 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_19compact_range(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyMarbleDB_18compact_range, "PyMarbleDB.compact_range(self)\n\nCompact all data in the database.");
static PyMethodDef __pyx_mdef_8marbledb_10PyMarbleDB_19compact_range = {"compact_range", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyMarbleDB_19compact_range, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyMarbleDB_18compact_range};
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_19compact_range(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compact_range (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compact_range", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return NULL;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("compact_range", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB_18compact_range(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyMarbleDB_18compact_range(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self) {
  marble::Status __pyx_v_status;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.compact_range", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyMarbleDB_19compact_range, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB_compact_range, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[32]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_compact_range, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0576</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compact all data in the database.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0577</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;db == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0578</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Database not opened&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 578, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Database_not_opened};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 578, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 578, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0579</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0580</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span><span class="w"> </span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">CompactRange</span><span class="p">(</span><span class="n">KeyRange</span><span class="o">.</span><span class="n">All</span><span class="p">())</span></pre>
<pre class='cython code score-0 '>  __pyx_v_status = __pyx_v_self-&gt;db-&gt;CompactRange(marble::KeyRange::All());
</pre><pre class="cython line score-0">&#xA0;<span class="">0581</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0582</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0583</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Compaction failed: {status.ToString().decode(&#39;utf-8&#39;)}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>    __pyx_t_4 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 583, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 583, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_Compaction_failed, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 583, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_4);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_7};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 583, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 583, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0584</span>: </pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0585</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-21 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_21close(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyMarbleDB_20close, "PyMarbleDB.close(self)\n\nClose the database.");
static PyMethodDef __pyx_mdef_8marbledb_10PyMarbleDB_21close = {"close", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyMarbleDB_21close, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyMarbleDB_20close};
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_21close(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("close (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("close", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return NULL;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("close", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB_20close(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyMarbleDB_20close(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyMarbleDB_21close, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB_close, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[33]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 585, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_close, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 585, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0586</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Close the database.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0587</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;db == NULL);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0588</span>:             <span class="k">return</span>  <span class="c"># Already closed</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0589</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0590</span>:         <span class="c"># Delete the database pointer (destructor handles cleanup)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0591</span>:         <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span></pre>
<pre class='cython code score-0 '>  delete __pyx_v_self-&gt;db;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0592</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;db = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0593</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0594</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-20 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_23__enter__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyMarbleDB_22__enter__, "PyMarbleDB.__enter__(self)\n\nContext manager entry.");
static PyMethodDef __pyx_mdef_8marbledb_10PyMarbleDB_23__enter__ = {"__enter__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyMarbleDB_23__enter__, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyMarbleDB_22__enter__};
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_23__enter__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__enter__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs &gt; 0)) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__enter__", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len &lt; 0)) return NULL;
  if (unlikely(__pyx_kwds_len &gt; 0)) {<span class='pyx_c_api'>__Pyx_RejectKeywords</span>("__enter__", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB_22__enter__(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyMarbleDB_22__enter__(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyMarbleDB_23__enter__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB___enter, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[34]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 594, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_enter, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 594, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0595</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Context manager entry.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0596</span>:         <span class="k">return</span> <span class="bp">self</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_self);
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0597</span>: </pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0598</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span></pre>
<pre class='cython code score-36 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_25__exit__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyMarbleDB_24__exit__, "PyMarbleDB.__exit__(self, exc_type, exc_val, exc_tb)\n\nContext manager exit.");
static PyMethodDef __pyx_mdef_8marbledb_10PyMarbleDB_25__exit__ = {"__exit__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyMarbleDB_25__exit__, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyMarbleDB_24__exit__};
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_25__exit__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_exc_type = 0;
  CYTHON_UNUSED PyObject *__pyx_v_exc_val = 0;
  CYTHON_UNUSED PyObject *__pyx_v_exc_tb = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__exit__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_exc_type,&amp;__pyx_mstate_global-&gt;__pyx_n_u_exc_val,&amp;__pyx_mstate_global-&gt;__pyx_n_u_exc_tb,0};
  PyObject* values[3] = {0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 598, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 598, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 598, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 598, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__exit__", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 598, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 3; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__exit__", 1, 3, 3, i); <span class='error_goto'>__PYX_ERR(0, 598, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 598, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 598, __pyx_L3_error)</span>
      values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 598, __pyx_L3_error)</span>
    }
    __pyx_v_exc_type = values[0];
    __pyx_v_exc_val = values[1];
    __pyx_v_exc_tb = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__exit__", 1, 3, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 598, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.__exit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB_24__exit__(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self), __pyx_v_exc_type, __pyx_v_exc_val, __pyx_v_exc_tb);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyMarbleDB_24__exit__(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_exc_type, CYTHON_UNUSED PyObject *__pyx_v_exc_val, CYTHON_UNUSED PyObject *__pyx_v_exc_tb) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyMarbleDB_25__exit__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB___exit, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[35]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_exit, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 598, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0599</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Context manager exit.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0600</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">!=</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;db != NULL);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0601</span>:             <span class="k">try</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>    {
      /*try:*/ {
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L9_try_end;
      __pyx_L4_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0602</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>        __pyx_t_6 = ((PyObject *)__pyx_v_self);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        __pyx_t_7 = 0;
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_close, __pyx_callargs+__pyx_t_7, (1-__pyx_t_7) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 602, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0603</span>:             <span class="k">except</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>      /*except:*/ {
        <span class='pyx_c_api'>__Pyx_ErrRestore</span>(0,0,0);
        goto __pyx_L5_exception_handled;
      }
      __pyx_L5_exception_handled:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);
      __pyx_L9_try_end:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0604</span>:                 <span class="k">pass</span>  <span class="c"># Ignore errors on close</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0605</span>:         <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  __pyx_r = Py_False;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0606</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0607</span>:     <span class="c"># ========== Bitemporal/Temporal Operations ==========</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0608</span>: </pre>
<pre class="cython line score-82" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0609</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">temporal_scan_dedup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">table_name</span><span class="p">,</span> <span class="nb">list</span> <span class="n">key_columns</span><span class="p">,</span></pre>
<pre class='cython code score-82 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_27temporal_scan_dedup(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyMarbleDB_26temporal_scan_dedup, "PyMarbleDB.temporal_scan_dedup(self, str table_name, list key_columns, uint64_t query_time=0, uint64_t valid_time_start=0, uint64_t valid_time_end=18446744073709551615, bool include_deleted=False)\n\nScan a temporal table with deduplication and time filtering.\n\nThis is the primary method for querying bitemporal tables. It:\n1. Filters by system time (query_time=0 means \"current\")\n2. Filters by valid time range (business time)\n3. Deduplicates by business key (latest version wins)\n4. Optionally includes deleted records\n\nArgs:\n    table_name: Name of the temporal table\n    key_columns: List of column names that form the business key\n    query_time: System time to query as of (0 = current time)\n    valid_time_start: Start of valid time range (microseconds since epoch)\n    valid_time_end: End of valid time range (UINT64_MAX = infinity)\n    include_deleted: If True, include tombstoned records\n\nReturns:\n    PyQueryResult that can be converted to Arrow Table\n\nExample:\n    # Query current state\n    result = db.temporal_scan_dedup(\"employees\", [\"employee_id\"])\n    table = result.to_table()\n\n    # Query as of specific valid time (Jan 1, 2023)\n    jan_2023 = 1672531200000000  # microseconds\n    result = db.temporal_scan_dedup(\"salaries\", [\"emp_id\"],\n                                   valid_time_start=jan_2023,\n                                   valid_time_end=jan_2023 + 1)");
static PyMethodDef __pyx_mdef_8marbledb_10PyMarbleDB_27temporal_scan_dedup = {"temporal_scan_dedup", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyMarbleDB_27temporal_scan_dedup, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyMarbleDB_26temporal_scan_dedup};
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_27temporal_scan_dedup(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_table_name = 0;
  PyObject *__pyx_v_key_columns = 0;
  uint64_t __pyx_v_query_time;
  uint64_t __pyx_v_valid_time_start;
  uint64_t __pyx_v_valid_time_end;
  bool __pyx_v_include_deleted;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("temporal_scan_dedup (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_table_name,&amp;__pyx_mstate_global-&gt;__pyx_n_u_key_columns,&amp;__pyx_mstate_global-&gt;__pyx_n_u_query_time,&amp;__pyx_mstate_global-&gt;__pyx_n_u_valid_time_start,&amp;__pyx_mstate_global-&gt;__pyx_n_u_valid_time_end,&amp;__pyx_mstate_global-&gt;__pyx_n_u_include_deleted,0};
  PyObject* values[6] = {0,0,0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  6:
        values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "temporal_scan_dedup", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 2; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("temporal_scan_dedup", 0, 2, 6, i); <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span> }
      }
    } else {
      switch (__pyx_nargs) {
        case  6:
        values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_table_name = ((PyObject*)values[0]);
    __pyx_v_key_columns = ((PyObject*)values[1]);
    if (values[2]) {
      __pyx_v_query_time = __Pyx_PyLong_As_uint64_t(values[2]); if (unlikely((__pyx_v_query_time == ((uint64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 610, __pyx_L3_error)</span>
    } else {
      __pyx_v_query_time = ((uint64_t)0);
    }
    if (values[3]) {
      __pyx_v_valid_time_start = __Pyx_PyLong_As_uint64_t(values[3]); if (unlikely((__pyx_v_valid_time_start == ((uint64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 611, __pyx_L3_error)</span>
    } else {
      __pyx_v_valid_time_start = ((uint64_t)0);
    }
    if (values[4]) {
      __pyx_v_valid_time_end = __Pyx_PyLong_As_uint64_t(values[4]); if (unlikely((__pyx_v_valid_time_end == ((uint64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 612, __pyx_L3_error)</span>
    } else {
      __pyx_v_valid_time_end = ((uint64_t)0xFFFFFFFFFFFFFFFF);
    }
    if (values[5]) {
      __pyx_v_include_deleted = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(values[5]); if (unlikely((__pyx_v_include_deleted == ((bool)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 613, __pyx_L3_error)</span>
    } else {
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyMarbleDB_26temporal_scan_dedup(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self, PyObject *__pyx_v_table_name, PyObject *__pyx_v_key_columns, uint64_t __pyx_v_query_time, uint64_t __pyx_v_valid_time_start, uint64_t __pyx_v_valid_time_end, bool __pyx_v_include_deleted) {
  std::vector&lt;std::string&gt;  __pyx_v_cpp_key_columns;
  PyObject *__pyx_v_col = NULL;
  std::unique_ptr&lt;marble::QueryResult&gt;  __pyx_v_result;
  marble::Status __pyx_v_status;
  struct __pyx_obj_8marbledb_PyQueryResult *__pyx_v_py_result = NULL;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.temporal_scan_dedup", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_col);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_py_result);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyMarbleDB_27temporal_scan_dedup, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB_temporal_scan_dedup, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[36]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 609, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_tuple[2]);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_temporal_scan_dedup, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_mstate_global-&gt;__pyx_tuple[2] = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_mstate_global-&gt;__pyx_int_0, __pyx_mstate_global-&gt;__pyx_int_0, __pyx_mstate_global-&gt;__pyx_int_0xffffffffffffffff, Py_False); if (unlikely(!__pyx_mstate_global-&gt;__pyx_tuple[2])) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[2]);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[2]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0610</span>:                            <span class="n">uint64_t</span> <span class="n">query_time</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0611</span>:                            <span class="n">uint64_t</span> <span class="n">valid_time_start</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0612</span>:                            <span class="n">uint64_t</span> <span class="n">valid_time_end</span><span class="o">=</span><span class="mf">18446744073709551615</span><span class="p">,</span>  <span class="c"># UINT64_MAX</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0613</span>:                            <span class="nb">bool</span> <span class="n">include_deleted</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span></pre>
<pre class='cython code score-8 '>      __pyx_v_include_deleted = ((bool)0);
    }
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("temporal_scan_dedup", 0, 2, 6, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.temporal_scan_dedup", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_table_name), (&amp;PyUnicode_Type), 1, "table_name", 1))) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_key_columns), (&amp;PyList_Type), 1, "key_columns", 1))) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB_26temporal_scan_dedup(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self), __pyx_v_table_name, __pyx_v_key_columns, __pyx_v_query_time, __pyx_v_valid_time_start, __pyx_v_valid_time_end, __pyx_v_include_deleted);
</pre><pre class="cython line score-0">&#xA0;<span class="">0614</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0615</span>: <span class="sd">        Scan a temporal table with deduplication and time filtering.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0616</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0617</span>: <span class="sd">        This is the primary method for querying bitemporal tables. It:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0618</span>: <span class="sd">        1. Filters by system time (query_time=0 means &quot;current&quot;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0619</span>: <span class="sd">        2. Filters by valid time range (business time)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0620</span>: <span class="sd">        3. Deduplicates by business key (latest version wins)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0621</span>: <span class="sd">        4. Optionally includes deleted records</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0622</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0623</span>: <span class="sd">        Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0624</span>: <span class="sd">            table_name: Name of the temporal table</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0625</span>: <span class="sd">            key_columns: List of column names that form the business key</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0626</span>: <span class="sd">            query_time: System time to query as of (0 = current time)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0627</span>: <span class="sd">            valid_time_start: Start of valid time range (microseconds since epoch)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0628</span>: <span class="sd">            valid_time_end: End of valid time range (UINT64_MAX = infinity)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0629</span>: <span class="sd">            include_deleted: If True, include tombstoned records</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0630</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0631</span>: <span class="sd">        Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0632</span>: <span class="sd">            PyQueryResult that can be converted to Arrow Table</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0633</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0634</span>: <span class="sd">        Example:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0635</span>: <span class="sd">            # Query current state</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0636</span>: <span class="sd">            result = db.temporal_scan_dedup(&quot;employees&quot;, [&quot;employee_id&quot;])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0637</span>: <span class="sd">            table = result.to_table()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0638</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0639</span>: <span class="sd">            # Query as of specific valid time (Jan 1, 2023)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0640</span>: <span class="sd">            jan_2023 = 1672531200000000  # microseconds</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0641</span>: <span class="sd">            result = db.temporal_scan_dedup(&quot;salaries&quot;, [&quot;emp_id&quot;],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0642</span>: <span class="sd">                                           valid_time_start=jan_2023,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0643</span>: <span class="sd">                                           valid_time_end=jan_2023 + 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0644</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0645</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;db == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0646</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Database not opened&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Database_not_opened};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 646, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 646, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0647</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0648</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">vector</span>[<span class="kt">string</span>] <span class="nf">cpp_key_columns</span></pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0649</span>:         <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">key_columns</span><span class="p">:</span></pre>
<pre class='cython code score-12 '>  if (unlikely(__pyx_v_key_columns == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>__PYX_ERR(0, 649, __pyx_L1_error)</span>
  }
  __pyx_t_2 = __pyx_v_key_columns; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_6 = 0;
  for (;;) {
    {
      Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
      #if !CYTHON_ASSUME_SAFE_SIZE
      if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 649, __pyx_L1_error)</span>
      #endif
      if (__pyx_t_6 &gt;= __pyx_temp) break;
    }
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_2, __pyx_t_6);
    ++__pyx_t_6;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 649, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col, __pyx_t_4);
    __pyx_t_4 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0650</span>:             <span class="n">cpp_key_columns</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span></pre>
<pre class='cython code score-5 '>    __pyx_t_3 = __pyx_v_col;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_5 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_utf_8};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_encode, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 650, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    __pyx_t_7 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_4);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    try {
      __pyx_v_cpp_key_columns.push_back(__pyx_t_7);
    } catch(...) {
      __Pyx_CppExn2PyErr();
      <span class='error_goto'>__PYX_ERR(0, 650, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0651</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0652</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">unique_ptr</span>[<span class="kt">QueryResult</span>] <span class="nf">result</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0653</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span><span class="w"> </span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">TemporalScanDedup</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_status = __pyx_v_self-&gt;db-&gt;TemporalScanDedup(__pyx_t_7, __pyx_v_cpp_key_columns, __pyx_v_query_time, __pyx_v_valid_time_start, __pyx_v_valid_time_end, __pyx_v_include_deleted, (&amp;__pyx_v_result));
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0654</span>:             <span class="n">table_name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">),</span></pre>
<pre class='cython code score-6 '>  if (unlikely(__pyx_v_table_name == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "encode");
    <span class='error_goto'>__PYX_ERR(0, 654, __pyx_L1_error)</span>
  }
  __pyx_t_2 = PyUnicode_AsUTF8String(__pyx_v_table_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 654, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_2);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 654, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0655</span>:             <span class="n">cpp_key_columns</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0656</span>:             <span class="n">query_time</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0657</span>:             <span class="n">valid_time_start</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0658</span>:             <span class="n">valid_time_end</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0659</span>:             <span class="n">include_deleted</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0660</span>:             <span class="o">&amp;</span><span class="n">result</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0661</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0662</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0663</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0664</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;TemporalScanDedup failed: {status.ToString().decode(&#39;utf-8&#39;)}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>    __pyx_t_4 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_8 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_TemporalScanDedup_failed, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_4);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_9};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 664, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 664, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0665</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0666</span>:         <span class="n">py_result</span> <span class="o">=</span> <span class="n">PyQueryResult</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyQueryResult);
  __pyx_t_9 = ((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyQueryResult); 
  __pyx_t_5 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 666, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_t_2);
  }
  __pyx_v_py_result = ((struct __pyx_obj_8marbledb_PyQueryResult *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0667</span>:         <span class="n">py_result</span><span class="o">.</span><span class="n">_set_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_8marbledb_PyQueryResult *)__pyx_v_py_result-&gt;__pyx_vtab)-&gt;_set_result(__pyx_v_py_result, __pyx_v_result);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 667, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0668</span>:         <span class="k">return</span> <span class="n">py_result</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_py_result);
  __pyx_r = ((PyObject *)__pyx_v_py_result);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0669</span>: </pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0670</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">temporal_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">table_name</span><span class="p">,</span> <span class="nb">list</span> <span class="n">key_columns</span><span class="p">,</span></pre>
<pre class='cython code score-53 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_29temporal_update(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyMarbleDB_28temporal_update, "PyMarbleDB.temporal_update(self, str table_name, list key_columns, key_batch, updated_batch)\n\nUpdate records in a temporal table (preserves history).\n\nUnlike regular update, this:\n1. Closes the old version (sets _system_time_end = now)\n2. Inserts the new version with _system_time_start = now\n\nArgs:\n    table_name: Name of the temporal table\n    key_columns: List of column names that identify records to update\n    key_batch: pyarrow.RecordBatch with key column values\n    updated_batch: pyarrow.RecordBatch with new values\n\nExample:\n    # Update employee salary\n    keys = pa.record_batch({\"employee_id\": [\"EMP001\"]}, ...)\n    new_data = pa.record_batch({\"employee_id\": [\"EMP001\"], \"salary\": [75000]}, ...)\n    db.temporal_update(\"employees\", [\"employee_id\"], keys, new_data)");
static PyMethodDef __pyx_mdef_8marbledb_10PyMarbleDB_29temporal_update = {"temporal_update", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyMarbleDB_29temporal_update, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyMarbleDB_28temporal_update};
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_29temporal_update(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_table_name = 0;
  PyObject *__pyx_v_key_columns = 0;
  PyObject *__pyx_v_key_batch = 0;
  PyObject *__pyx_v_updated_batch = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("temporal_update (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_table_name,&amp;__pyx_mstate_global-&gt;__pyx_n_u_key_columns,&amp;__pyx_mstate_global-&gt;__pyx_n_u_key_batch,&amp;__pyx_mstate_global-&gt;__pyx_n_u_updated_batch,0};
  PyObject* values[4] = {0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "temporal_update", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 4; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("temporal_update", 1, 4, 4, i); <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L3_error)</span>
      values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L3_error)</span>
      values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L3_error)</span>
    }
    __pyx_v_table_name = ((PyObject*)values[0]);
    __pyx_v_key_columns = ((PyObject*)values[1]);
    __pyx_v_key_batch = values[2];
    __pyx_v_updated_batch = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("temporal_update", 1, 4, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.temporal_update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_table_name), (&amp;PyUnicode_Type), 1, "table_name", 1))) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_key_columns), (&amp;PyList_Type), 1, "key_columns", 1))) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB_28temporal_update(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self), __pyx_v_table_name, __pyx_v_key_columns, __pyx_v_key_batch, __pyx_v_updated_batch);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyMarbleDB_28temporal_update(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self, PyObject *__pyx_v_table_name, PyObject *__pyx_v_key_columns, PyObject *__pyx_v_key_batch, PyObject *__pyx_v_updated_batch) {
  std::vector&lt;std::string&gt;  __pyx_v_cpp_key_columns;
  PyObject *__pyx_v_col = NULL;
  std::shared_ptr&lt; arrow::RecordBatch&gt;  __pyx_v_c_key_batch;
  std::shared_ptr&lt; arrow::RecordBatch&gt;  __pyx_v_c_updated_batch;
  marble::Status __pyx_v_status;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.temporal_update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_col);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyMarbleDB_29temporal_update, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB_temporal_update, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[37]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_temporal_update, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0671</span>:                        <span class="n">key_batch</span><span class="p">,</span> <span class="n">updated_batch</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0672</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0673</span>: <span class="sd">        Update records in a temporal table (preserves history).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0674</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0675</span>: <span class="sd">        Unlike regular update, this:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0676</span>: <span class="sd">        1. Closes the old version (sets _system_time_end = now)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0677</span>: <span class="sd">        2. Inserts the new version with _system_time_start = now</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0678</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0679</span>: <span class="sd">        Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0680</span>: <span class="sd">            table_name: Name of the temporal table</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0681</span>: <span class="sd">            key_columns: List of column names that identify records to update</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0682</span>: <span class="sd">            key_batch: pyarrow.RecordBatch with key column values</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0683</span>: <span class="sd">            updated_batch: pyarrow.RecordBatch with new values</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0684</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0685</span>: <span class="sd">        Example:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0686</span>: <span class="sd">            # Update employee salary</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0687</span>: <span class="sd">            keys = pa.record_batch({&quot;employee_id&quot;: [&quot;EMP001&quot;]}, ...)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0688</span>: <span class="sd">            new_data = pa.record_batch({&quot;employee_id&quot;: [&quot;EMP001&quot;], &quot;salary&quot;: [75000]}, ...)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0689</span>: <span class="sd">            db.temporal_update(&quot;employees&quot;, [&quot;employee_id&quot;], keys, new_data)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0690</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0691</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;db == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0692</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Database not opened&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Database_not_opened};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 692, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 692, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0693</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0694</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">vector</span>[<span class="kt">string</span>] <span class="nf">cpp_key_columns</span></pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0695</span>:         <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">key_columns</span><span class="p">:</span></pre>
<pre class='cython code score-12 '>  if (unlikely(__pyx_v_key_columns == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>
  }
  __pyx_t_2 = __pyx_v_key_columns; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_6 = 0;
  for (;;) {
    {
      Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
      #if !CYTHON_ASSUME_SAFE_SIZE
      if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>
      #endif
      if (__pyx_t_6 &gt;= __pyx_temp) break;
    }
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_2, __pyx_t_6);
    ++__pyx_t_6;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col, __pyx_t_4);
    __pyx_t_4 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0696</span>:             <span class="n">cpp_key_columns</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span></pre>
<pre class='cython code score-5 '>    __pyx_t_3 = __pyx_v_col;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_5 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_utf_8};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_encode, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 696, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    __pyx_t_7 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_4);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 696, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    try {
      __pyx_v_cpp_key_columns.push_back(__pyx_t_7);
    } catch(...) {
      __Pyx_CppExn2PyErr();
      <span class='error_goto'>__PYX_ERR(0, 696, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0697</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0698</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">CRecordBatch</span>] <span class="nf">c_key_batch</span><span class="w"> </span><span class="o">=</span> <span class="n">pyarrow_unwrap_batch</span><span class="p">(</span><span class="n">key_batch</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __pyx_f_7pyarrow_3lib_pyarrow_unwrap_batch(__pyx_v_key_batch);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 698, __pyx_L1_error)</span>
  __pyx_v_c_key_batch = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_8);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0699</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">CRecordBatch</span>] <span class="nf">c_updated_batch</span><span class="w"> </span><span class="o">=</span> <span class="n">pyarrow_unwrap_batch</span><span class="p">(</span><span class="n">updated_batch</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __pyx_f_7pyarrow_3lib_pyarrow_unwrap_batch(__pyx_v_updated_batch);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 699, __pyx_L1_error)</span>
  __pyx_v_c_updated_batch = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_8);
</pre><pre class="cython line score-0">&#xA0;<span class="">0700</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0701</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span><span class="w"> </span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">TemporalUpdate</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_status = __pyx_v_self-&gt;db-&gt;TemporalUpdate(__pyx_t_7, __pyx_v_cpp_key_columns, __pyx_v_c_key_batch, __pyx_v_c_updated_batch);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0702</span>:             <span class="n">table_name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">),</span></pre>
<pre class='cython code score-6 '>  if (unlikely(__pyx_v_table_name == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "encode");
    <span class='error_goto'>__PYX_ERR(0, 702, __pyx_L1_error)</span>
  }
  __pyx_t_2 = PyUnicode_AsUTF8String(__pyx_v_table_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 702, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_2);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 702, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0703</span>:             <span class="n">cpp_key_columns</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0704</span>:             <span class="n">c_key_batch</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0705</span>:             <span class="n">c_updated_batch</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0706</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0707</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0708</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0709</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;TemporalUpdate failed: {status.ToString().decode(&#39;utf-8&#39;)}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>    __pyx_t_4 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 709, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_9 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 709, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_TemporalUpdate_failed, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 709, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_4);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_10};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0710</span>: </pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0711</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">temporal_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">table_name</span><span class="p">,</span> <span class="nb">list</span> <span class="n">key_columns</span><span class="p">,</span> <span class="n">key_batch</span><span class="p">):</span></pre>
<pre class='cython code score-49 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_31temporal_delete(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyMarbleDB_30temporal_delete, "PyMarbleDB.temporal_delete(self, str table_name, list key_columns, key_batch)\n\nDelete records from a temporal table (preserves history).\n\nThis doesn't physically delete data. Instead, it:\n1. Closes the current version (sets _system_time_end = now)\n2. Inserts a tombstone with _is_deleted = true\n\nArgs:\n    table_name: Name of the temporal table\n    key_columns: List of column names that identify records to delete\n    key_batch: pyarrow.RecordBatch with key column values\n\nExample:\n    # Delete employee record\n    keys = pa.record_batch({\"employee_id\": [\"EMP002\"]}, ...)\n    db.temporal_delete(\"employees\", [\"employee_id\"], keys)");
static PyMethodDef __pyx_mdef_8marbledb_10PyMarbleDB_31temporal_delete = {"temporal_delete", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyMarbleDB_31temporal_delete, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyMarbleDB_30temporal_delete};
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_31temporal_delete(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_table_name = 0;
  PyObject *__pyx_v_key_columns = 0;
  PyObject *__pyx_v_key_batch = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("temporal_delete (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_table_name,&amp;__pyx_mstate_global-&gt;__pyx_n_u_key_columns,&amp;__pyx_mstate_global-&gt;__pyx_n_u_key_batch,0};
  PyObject* values[3] = {0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "temporal_delete", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 3; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("temporal_delete", 1, 3, 3, i); <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span>
      values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span>
    }
    __pyx_v_table_name = ((PyObject*)values[0]);
    __pyx_v_key_columns = ((PyObject*)values[1]);
    __pyx_v_key_batch = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("temporal_delete", 1, 3, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.temporal_delete", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_table_name), (&amp;PyUnicode_Type), 1, "table_name", 1))) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_key_columns), (&amp;PyList_Type), 1, "key_columns", 1))) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB_30temporal_delete(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self), __pyx_v_table_name, __pyx_v_key_columns, __pyx_v_key_batch);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyMarbleDB_30temporal_delete(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self, PyObject *__pyx_v_table_name, PyObject *__pyx_v_key_columns, PyObject *__pyx_v_key_batch) {
  std::vector&lt;std::string&gt;  __pyx_v_cpp_key_columns;
  PyObject *__pyx_v_col = NULL;
  std::shared_ptr&lt; arrow::RecordBatch&gt;  __pyx_v_c_key_batch;
  marble::Status __pyx_v_status;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.temporal_delete", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_col);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyMarbleDB_31temporal_delete, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB_temporal_delete, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[38]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 711, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_temporal_delete, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0712</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0713</span>: <span class="sd">        Delete records from a temporal table (preserves history).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0714</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0715</span>: <span class="sd">        This doesn&#39;t physically delete data. Instead, it:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0716</span>: <span class="sd">        1. Closes the current version (sets _system_time_end = now)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0717</span>: <span class="sd">        2. Inserts a tombstone with _is_deleted = true</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0718</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0719</span>: <span class="sd">        Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0720</span>: <span class="sd">            table_name: Name of the temporal table</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0721</span>: <span class="sd">            key_columns: List of column names that identify records to delete</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0722</span>: <span class="sd">            key_batch: pyarrow.RecordBatch with key column values</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0723</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0724</span>: <span class="sd">        Example:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0725</span>: <span class="sd">            # Delete employee record</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0726</span>: <span class="sd">            keys = pa.record_batch({&quot;employee_id&quot;: [&quot;EMP002&quot;]}, ...)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0727</span>: <span class="sd">            db.temporal_delete(&quot;employees&quot;, [&quot;employee_id&quot;], keys)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0728</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0729</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;db == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0730</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Database not opened&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Database_not_opened};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0731</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0732</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">vector</span>[<span class="kt">string</span>] <span class="nf">cpp_key_columns</span></pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0733</span>:         <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">key_columns</span><span class="p">:</span></pre>
<pre class='cython code score-12 '>  if (unlikely(__pyx_v_key_columns == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>__PYX_ERR(0, 733, __pyx_L1_error)</span>
  }
  __pyx_t_2 = __pyx_v_key_columns; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_6 = 0;
  for (;;) {
    {
      Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
      #if !CYTHON_ASSUME_SAFE_SIZE
      if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 733, __pyx_L1_error)</span>
      #endif
      if (__pyx_t_6 &gt;= __pyx_temp) break;
    }
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_2, __pyx_t_6);
    ++__pyx_t_6;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 733, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col, __pyx_t_4);
    __pyx_t_4 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0734</span>:             <span class="n">cpp_key_columns</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span></pre>
<pre class='cython code score-5 '>    __pyx_t_3 = __pyx_v_col;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_5 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_utf_8};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_encode, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 734, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    __pyx_t_7 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_4);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 734, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    try {
      __pyx_v_cpp_key_columns.push_back(__pyx_t_7);
    } catch(...) {
      __Pyx_CppExn2PyErr();
      <span class='error_goto'>__PYX_ERR(0, 734, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0735</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0736</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">CRecordBatch</span>] <span class="nf">c_key_batch</span><span class="w"> </span><span class="o">=</span> <span class="n">pyarrow_unwrap_batch</span><span class="p">(</span><span class="n">key_batch</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __pyx_f_7pyarrow_3lib_pyarrow_unwrap_batch(__pyx_v_key_batch);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 736, __pyx_L1_error)</span>
  __pyx_v_c_key_batch = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_8);
</pre><pre class="cython line score-0">&#xA0;<span class="">0737</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0738</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span><span class="w"> </span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">TemporalDelete</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_status = __pyx_v_self-&gt;db-&gt;TemporalDelete(__pyx_t_7, __pyx_v_cpp_key_columns, __pyx_v_c_key_batch);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0739</span>:             <span class="n">table_name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">),</span></pre>
<pre class='cython code score-6 '>  if (unlikely(__pyx_v_table_name == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "encode");
    <span class='error_goto'>__PYX_ERR(0, 739, __pyx_L1_error)</span>
  }
  __pyx_t_2 = PyUnicode_AsUTF8String(__pyx_v_table_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_2);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 739, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0740</span>:             <span class="n">cpp_key_columns</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0741</span>:             <span class="n">c_key_batch</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0742</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0743</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0744</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0745</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;TemporalDelete failed: {status.ToString().decode(&#39;utf-8&#39;)}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>    __pyx_t_4 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 745, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_9 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 745, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_TemporalDelete_failed, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 745, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_4);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_10};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0746</span>: </pre>
<pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0747</span>:     <span class="k">def</span><span class="w"> </span><span class="nf">prune_versions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">max_versions_per_key</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span></pre>
<pre class='cython code score-64 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_33prune_versions(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_10PyMarbleDB_32prune_versions, "PyMarbleDB.prune_versions(self, str table_name, size_t max_versions_per_key=0, uint64_t min_system_time_us=0)\n\nGarbage collect old versions from a temporal table.\n\nBased on the table's GC policy (set at creation time):\n- kKeepAllVersions: No pruning (audit mode)\n- kKeepRecentVersions: Keep N most recent versions per key\n- kKeepVersionsUntil: Remove versions closed before timestamp\n\nArgs:\n    table_name: Name of the temporal table\n    max_versions_per_key: Override max versions (0 = use table setting)\n    min_system_time_us: Override timestamp threshold (0 = use table setting)\n\nReturns:\n    Number of versions removed\n\nExample:\n    # Prune using table's GC settings\n    removed = db.prune_versions(\"employees\")\n    print(f\"Pruned {removed} old versions\")\n\n    # Prune keeping only 2 versions per key\n    removed = db.prune_versions(\"employees\", max_versions_per_key=2)");
static PyMethodDef __pyx_mdef_8marbledb_10PyMarbleDB_33prune_versions = {"prune_versions", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_10PyMarbleDB_33prune_versions, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_10PyMarbleDB_32prune_versions};
static PyObject *__pyx_pw_8marbledb_10PyMarbleDB_33prune_versions(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_table_name = 0;
  size_t __pyx_v_max_versions_per_key;
  uint64_t __pyx_v_min_system_time_us;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("prune_versions (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_table_name,&amp;__pyx_mstate_global-&gt;__pyx_n_u_max_versions_per_key,&amp;__pyx_mstate_global-&gt;__pyx_n_u_min_system_time_us,0};
  PyObject* values[3] = {0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "prune_versions", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 1; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prune_versions", 0, 1, 3, i); <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L3_error)</span> }
      }
    } else {
      switch (__pyx_nargs) {
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L3_error)</span>
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_table_name = ((PyObject*)values[0]);
    if (values[1]) {
      __pyx_v_max_versions_per_key = <span class='pyx_c_api'>__Pyx_PyLong_As_size_t</span>(values[1]); if (unlikely((__pyx_v_max_versions_per_key == (size_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_versions_per_key = ((size_t)0);
    }
    if (values[2]) {
      __pyx_v_min_system_time_us = __Pyx_PyLong_As_uint64_t(values[2]); if (unlikely((__pyx_v_min_system_time_us == ((uint64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 748, __pyx_L3_error)</span>
    } else {
      __pyx_v_min_system_time_us = ((uint64_t)0);
    }
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prune_versions", 0, 1, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.prune_versions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_table_name), (&amp;PyUnicode_Type), 1, "table_name", 1))) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8marbledb_10PyMarbleDB_32prune_versions(((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_v_self), __pyx_v_table_name, __pyx_v_max_versions_per_key, __pyx_v_min_system_time_us);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_10PyMarbleDB_32prune_versions(struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_v_self, PyObject *__pyx_v_table_name, size_t __pyx_v_max_versions_per_key, uint64_t __pyx_v_min_system_time_us) {
  uint64_t __pyx_v_versions_removed;
  marble::Status __pyx_v_status;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.PyMarbleDB.prune_versions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_10PyMarbleDB_33prune_versions, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB_prune_versions, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[39]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 747, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_tuple[3]);
  if (<span class='pyx_c_api'>__Pyx_SetItemOnTypeDict</span>(__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB, __pyx_mstate_global-&gt;__pyx_n_u_prune_versions, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_mstate_global-&gt;__pyx_tuple[3] = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_mstate_global-&gt;__pyx_int_0, __pyx_mstate_global-&gt;__pyx_int_0); if (unlikely(!__pyx_mstate_global-&gt;__pyx_tuple[3])) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[3]);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[3]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0748</span>:                       <span class="n">uint64_t</span> <span class="n">min_system_time_us</span><span class="o">=</span><span class="mf">0</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0749</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0750</span>: <span class="sd">        Garbage collect old versions from a temporal table.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0751</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0752</span>: <span class="sd">        Based on the table&#39;s GC policy (set at creation time):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0753</span>: <span class="sd">        - kKeepAllVersions: No pruning (audit mode)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0754</span>: <span class="sd">        - kKeepRecentVersions: Keep N most recent versions per key</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0755</span>: <span class="sd">        - kKeepVersionsUntil: Remove versions closed before timestamp</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0756</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0757</span>: <span class="sd">        Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0758</span>: <span class="sd">            table_name: Name of the temporal table</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0759</span>: <span class="sd">            max_versions_per_key: Override max versions (0 = use table setting)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0760</span>: <span class="sd">            min_system_time_us: Override timestamp threshold (0 = use table setting)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0761</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0762</span>: <span class="sd">        Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0763</span>: <span class="sd">            Number of versions removed</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0764</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0765</span>: <span class="sd">        Example:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0766</span>: <span class="sd">            # Prune using table&#39;s GC settings</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0767</span>: <span class="sd">            removed = db.prune_versions(&quot;employees&quot;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0768</span>: <span class="sd">            print(f&quot;Pruned {removed} old versions&quot;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0769</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0770</span>: <span class="sd">            # Prune keeping only 2 versions per key</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0771</span>: <span class="sd">            removed = db.prune_versions(&quot;employees&quot;, max_versions_per_key=2)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0772</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0773</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;db == NULL);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0774</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="s">&quot;Database not opened&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_Database_not_opened};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 774, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 774, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0775</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0776</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">uint64_t</span> <span class="nf">versions_removed</span><span class="w"> </span><span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_versions_removed = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0777</span>:         <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0778</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0779</span>:         <span class="k">if</span> <span class="n">max_versions_per_key</span> <span class="o">&gt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">min_system_time_us</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = (__pyx_v_max_versions_per_key &gt; 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_1 = __pyx_t_6;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_6 = (__pyx_v_min_system_time_us &gt; 0);
  __pyx_t_1 = __pyx_t_6;
  __pyx_L5_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0780</span>:             <span class="c"># Use custom parameters</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0781</span>:             <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">PruneVersions</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>    __pyx_v_status = __pyx_v_self-&gt;db-&gt;PruneVersions(__pyx_t_7, __pyx_t_5, __pyx_v_min_system_time_us, (&amp;__pyx_v_versions_removed));
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0782</span>:                 <span class="n">table_name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">),</span></pre>
<pre class='cython code score-6 '>    if (unlikely(__pyx_v_table_name == Py_None)) {
      <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "encode");
      <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L1_error)</span>
    }
    __pyx_t_2 = PyUnicode_AsUTF8String(__pyx_v_table_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_2);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 782, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0783</span>:                 <span class="n">max_versions_per_key</span> <span class="k">if</span> <span class="n">max_versions_per_key</span> <span class="o">&gt;</span> <span class="mf">0</span> <span class="k">else</span> <span class="mf">10</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = (__pyx_v_max_versions_per_key &gt; 0);
    if (__pyx_t_1) {
      __pyx_t_5 = __pyx_v_max_versions_per_key;
    } else {
      __pyx_t_5 = 10;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0784</span>:                 <span class="n">min_system_time_us</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0785</span>:                 <span class="o">&amp;</span><span class="n">versions_removed</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0786</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0787</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0788</span>:             <span class="c"># Use table&#39;s default GC settings</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0789</span>:             <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">PruneVersions</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
/* … */
    __pyx_v_status = __pyx_v_self-&gt;db-&gt;PruneVersions(__pyx_t_7, (&amp;__pyx_v_versions_removed));
  }
  __pyx_L4:;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0790</span>:                 <span class="n">table_name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">),</span></pre>
<pre class='cython code score-6 '>    if (unlikely(__pyx_v_table_name == Py_None)) {
      <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "encode");
      <span class='error_goto'>__PYX_ERR(0, 790, __pyx_L1_error)</span>
    }
    __pyx_t_2 = PyUnicode_AsUTF8String(__pyx_v_table_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 790, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_2);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 790, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0791</span>:                 <span class="o">&amp;</span><span class="n">versions_removed</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0792</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0793</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0794</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0795</span>:             <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;PruneVersions failed: {status.ToString().decode(&#39;utf-8&#39;)}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>    __pyx_t_4 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 795, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_8 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 795, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_PruneVersions_failed, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 795, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_4);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_9};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 795, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 795, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0796</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0797</span>:         <span class="k">return</span> <span class="n">versions_removed</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = __Pyx_PyLong_From_uint64_t(__pyx_v_versions_removed);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0798</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0799</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0800</span>: <span class="c"># Module-level convenience function</span></pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0801</span>: <span class="k">def</span><span class="w"> </span><span class="nf">open_database</span><span class="p">(</span><span class="nb">str</span> <span class="n">db_path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PyMarbleDB</span><span class="p">:</span></pre>
<pre class='cython code score-49 '>/* Python wrapper */
static struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_pw_8marbledb_1open_database(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_open_database, "open_database(str db_path) -&gt; PyMarbleDB\n\nOpen a MarbleDB database at the specified path.\n\nThis is a convenience function that creates and opens a PyMarbleDB instance.\n\nArgs:\n    db_path: Path to the database directory (will be created if it doesn't exist)\n\nReturns:\n    PyMarbleDB instance ready for use\n\nExample:\n    db = marbledb.open_database(\"/tmp/my_database\")\n\n    # Create a bitemporal table\n    import pyarrow as pa\n    schema = pa.schema([\n        pa.field(\"employee_id\", pa.utf8()),\n        pa.field(\"salary\", pa.float64())\n    ])\n    caps = marbledb.PyTableCapabilities.bitemporal()\n    db.create_table(\"employees\", schema, caps)\n\n    # Insert, update, query with temporal support\n    db.insert_batch(\"employees\", batch)\n    results = db.temporal_scan_dedup(\"employees\", [\"employee_id\"])");
static PyMethodDef __pyx_mdef_8marbledb_1open_database = {"open_database", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_1open_database, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_open_database};
static struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_pw_8marbledb_1open_database(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_db_path = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("open_database (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_db_path,0};
  PyObject* values[1] = {0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 801, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 801, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "open_database", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 801, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 1; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("open_database", 1, 1, 1, i); <span class='error_goto'>__PYX_ERR(0, 801, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 801, __pyx_L3_error)</span>
    }
    __pyx_v_db_path = ((PyObject*)values[0]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("open_database", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 801, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.open_database", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_db_path), (&amp;PyUnicode_Type), 1, "db_path", 1))) <span class='error_goto'>__PYX_ERR(0, 801, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8marbledb_open_database(__pyx_self, __pyx_v_db_path);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_pf_8marbledb_open_database(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_db_path) {
  struct __pyx_obj_8marbledb_PyDBOptions *__pyx_v_options = 0;
  struct __pyx_obj_8marbledb_PyMarbleDB *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.open_database", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_options);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 801, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_return, __pyx_mstate_global-&gt;__pyx_n_u_PyMarbleDB) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 801, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_1open_database, 0, __pyx_mstate_global-&gt;__pyx_n_u_open_database, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[42]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 801, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_open_database, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 801, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0802</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0803</span>: <span class="sd">    Open a MarbleDB database at the specified path.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0804</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0805</span>: <span class="sd">    This is a convenience function that creates and opens a PyMarbleDB instance.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0806</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0807</span>: <span class="sd">    Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0808</span>: <span class="sd">        db_path: Path to the database directory (will be created if it doesn&#39;t exist)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0809</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0810</span>: <span class="sd">    Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0811</span>: <span class="sd">        PyMarbleDB instance ready for use</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0812</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0813</span>: <span class="sd">    Example:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0814</span>: <span class="sd">        db = marbledb.open_database(&quot;/tmp/my_database&quot;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0815</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0816</span>: <span class="sd">        # Create a bitemporal table</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0817</span>: <span class="sd">        import pyarrow as pa</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0818</span>: <span class="sd">        schema = pa.schema([</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0819</span>: <span class="sd">            pa.field(&quot;employee_id&quot;, pa.utf8()),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0820</span>: <span class="sd">            pa.field(&quot;salary&quot;, pa.float64())</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0821</span>: <span class="sd">        ])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0822</span>: <span class="sd">        caps = marbledb.PyTableCapabilities.bitemporal()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0823</span>: <span class="sd">        db.create_table(&quot;employees&quot;, schema, caps)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0824</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0825</span>: <span class="sd">        # Insert, update, query with temporal support</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0826</span>: <span class="sd">        db.insert_batch(&quot;employees&quot;, batch)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0827</span>: <span class="sd">        results = db.temporal_scan_dedup(&quot;employees&quot;, [&quot;employee_id&quot;])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0828</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0829</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">PyDBOptions</span> <span class="nf">options</span><span class="w"> </span><span class="o">=</span> <span class="n">PyDBOptions</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyDBOptions);
  __pyx_t_3 = ((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyDBOptions); 
  __pyx_t_4 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_4, (1-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 829, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_t_1);
  }
  __pyx_v_options = ((struct __pyx_obj_8marbledb_PyDBOptions *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0830</span>:     <span class="n">options</span><span class="o">.</span><span class="n">db_path</span> <span class="o">=</span> <span class="n">db_path</span></pre>
<pre class='cython code score-2 '>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(((PyObject *)__pyx_v_options), __pyx_mstate_global-&gt;__pyx_n_u_db_path, __pyx_v_db_path) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 830, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0831</span>:     <span class="k">return</span> <span class="n">PyMarbleDB</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">options</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_r);
  __pyx_t_3 = ((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_4 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, ((PyObject *)__pyx_v_options)};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_open, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 831, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_8marbledb_PyMarbleDB))))) <span class='error_goto'>__PYX_ERR(0, 831, __pyx_L1_error)</span>
  __pyx_r = ((struct __pyx_obj_8marbledb_PyMarbleDB *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0832</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0833</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0834</span>: <span class="c"># ========== Join Operations (Table-to-Table) ==========</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0835</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0836</span>: <span class="k">cdef</span><span class="w"> </span><span class="kt">JoinType</span> <span class="nf">_map_join_type</span><span class="p">(</span><span class="nb">str</span> <span class="n">how</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>static enum marble::JoinType __pyx_f_8marbledb__map_join_type(PyObject *__pyx_v_how) {
  enum marble::JoinType __pyx_r;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb._map_join_type", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = (enum marble::JoinType) 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0837</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Map string join type to C++ enum.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0838</span>:     <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="s">&#39;inner&#39;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_how, __pyx_mstate_global-&gt;__pyx_n_u_inner, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 838, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0839</span>:         <span class="k">return</span> <span class="n">JoinType</span><span class="o">.</span><span class="n">kInner</span></pre>
<pre class='cython code score-0 '>    __pyx_r = marble::JoinType::kInner;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0840</span>:     <span class="k">elif</span> <span class="n">how</span> <span class="o">==</span> <span class="s">&#39;left&#39;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_how, __pyx_mstate_global-&gt;__pyx_n_u_left, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 840, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0841</span>:         <span class="k">return</span> <span class="n">JoinType</span><span class="o">.</span><span class="n">kLeft</span></pre>
<pre class='cython code score-0 '>    __pyx_r = marble::JoinType::kLeft;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0842</span>:     <span class="k">elif</span> <span class="n">how</span> <span class="o">==</span> <span class="s">&#39;right&#39;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_how, __pyx_mstate_global-&gt;__pyx_n_u_right, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 842, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0843</span>:         <span class="k">return</span> <span class="n">JoinType</span><span class="o">.</span><span class="n">kRight</span></pre>
<pre class='cython code score-0 '>    __pyx_r = marble::JoinType::kRight;
    goto __pyx_L0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0844</span>:     <span class="k">elif</span> <span class="n">how</span> <span class="o">==</span> <span class="s">&#39;outer&#39;</span> <span class="ow">or</span> <span class="n">how</span> <span class="o">==</span> <span class="s">&#39;full&#39;</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_how, __pyx_mstate_global-&gt;__pyx_n_u_outer, Py_EQ)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 844, __pyx_L1_error)</span>
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_how, __pyx_mstate_global-&gt;__pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 844, __pyx_L1_error)</span>
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0845</span>:         <span class="k">return</span> <span class="n">JoinType</span><span class="o">.</span><span class="n">kFull</span></pre>
<pre class='cython code score-0 '>    __pyx_r = marble::JoinType::kFull;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0846</span>:     <span class="k">elif</span> <span class="n">how</span> <span class="o">==</span> <span class="s">&#39;cross&#39;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_how, __pyx_mstate_global-&gt;__pyx_n_u_cross, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 846, __pyx_L1_error)</span>
  if (likely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0847</span>:         <span class="k">return</span> <span class="n">JoinType</span><span class="o">.</span><span class="n">kCross</span></pre>
<pre class='cython code score-0 '>    __pyx_r = marble::JoinType::kCross;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0848</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0849</span>:         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Unknown join type: {how}. Use &#39;inner&#39;, &#39;left&#39;, &#39;right&#39;, &#39;outer&#39;, or &#39;cross&#39;&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-18 '>  /*else*/ {
    __pyx_t_4 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_builtin_ValueError);
    __pyx_t_5 = __pyx_builtin_ValueError; 
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyUnicode_Unicode</span>(__pyx_v_how);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 849, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7[0] = __pyx_mstate_global-&gt;__pyx_kp_u_Unknown_join_type;
    __pyx_t_7[1] = __pyx_t_6;
    __pyx_t_7[2] = __pyx_mstate_global-&gt;__pyx_kp_u_Use_inner_left_right_outer_or_c;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_7, 3, 19 + <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_6) + 51, 127 | <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_6));
    if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 849, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_9 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_8};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+__pyx_t_9, (2-__pyx_t_9) | (__pyx_t_9*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 849, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 849, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0850</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0851</span>: </pre>
<pre class="cython line score-100" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0852</span>: <span class="k">def</span><span class="w"> </span><span class="nf">hash_join</span><span class="p">(</span><span class="n">left_table</span><span class="p">,</span> <span class="n">right_table</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">&#39;inner&#39;</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span></pre>
<pre class='cython code score-100 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_3hash_join(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_2hash_join, "hash_join(left_table, right_table, on, how='inner', left_on=None, right_on=None, left_suffix='', right_suffix='_right')\n\nPerform hash join between two Arrow tables.\n\nThis uses Arrow Acero's HashJoinNode for efficient SIMD-optimized joining.\n\nArgs:\n    left_table: PyArrow Table (left side of join)\n    right_table: PyArrow Table (right side of join)\n    on: str or list of str - join key column(s) when columns have the same name\n    how: Join type - 'inner', 'left', 'right', 'outer'/'full', 'cross'\n    left_on: str or list of str - left key columns (use when names differ)\n    right_on: str or list of str - right key columns (use when names differ)\n    left_suffix: Suffix for left columns in case of name collision (default: '')\n    right_suffix: Suffix for right columns in case of name collision (default: '_right')\n\nReturns:\n    PyArrow Table with joined result\n\nExample:\n    # Simple join on same column name\n    result = marbledb.hash_join(employees, departments, on='department_id')\n\n    # Join with different column names\n    result = marbledb.hash_join(\n        orders, customers,\n        left_on='customer_id',\n        right_on='id',\n        how='left'\n    )\n\n    # Multiple key columns\n    result = marbledb.hash_join(\n        table1, table2,\n        on=['year', 'month', 'category']\n    )");
static PyMethodDef __pyx_mdef_8marbledb_3hash_join = {"hash_join", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_3hash_join, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_2hash_join};
static PyObject *__pyx_pw_8marbledb_3hash_join(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_left_table = 0;
  PyObject *__pyx_v_right_table = 0;
  PyObject *__pyx_v_on = 0;
  PyObject *__pyx_v_how = 0;
  PyObject *__pyx_v_left_on = 0;
  PyObject *__pyx_v_right_on = 0;
  PyObject *__pyx_v_left_suffix = 0;
  PyObject *__pyx_v_right_suffix = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("hash_join (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_left_table,&amp;__pyx_mstate_global-&gt;__pyx_n_u_right_table,&amp;__pyx_mstate_global-&gt;__pyx_n_u_on,&amp;__pyx_mstate_global-&gt;__pyx_n_u_how,&amp;__pyx_mstate_global-&gt;__pyx_n_u_left_on,&amp;__pyx_mstate_global-&gt;__pyx_n_u_right_on,&amp;__pyx_mstate_global-&gt;__pyx_n_u_left_suffix,&amp;__pyx_mstate_global-&gt;__pyx_n_u_right_suffix,0};
  PyObject* values[8] = {0,0,0,0,0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  8:
        values[7] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 7);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[7])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  7:
        values[6] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 6);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[6])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  6:
        values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "hash_join", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
      if (!values[3]) values[3] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_n_u_inner)));
      if (!values[4]) values[4] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)Py_None));
      if (!values[5]) values[5] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)Py_None));
      if (!values[6]) values[6] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u__4)));
      if (!values[7]) values[7] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_n_u_right_2)));
      for (Py_ssize_t i = __pyx_nargs; i &lt; 3; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hash_join", 0, 3, 8, i); <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span> }
      }
    } else {
      switch (__pyx_nargs) {
        case  8:
        values[7] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 7);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[7])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  7:
        values[6] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 6);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[6])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  6:
        values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[3]) values[3] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_n_u_inner)));
      if (!values[4]) values[4] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)Py_None));
      if (!values[5]) values[5] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)Py_None));
      if (!values[6]) values[6] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u__4)));
      if (!values[7]) values[7] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_n_u_right_2)));
    }
    __pyx_v_left_table = values[0];
    __pyx_v_right_table = values[1];
    __pyx_v_on = values[2];
    __pyx_v_how = values[3];
    __pyx_v_left_on = values[4];
    __pyx_v_right_on = values[5];
    __pyx_v_left_suffix = values[6];
    __pyx_v_right_suffix = values[7];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hash_join", 0, 3, 8, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.hash_join", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8marbledb_2hash_join(__pyx_self, __pyx_v_left_table, __pyx_v_right_table, __pyx_v_on, __pyx_v_how, __pyx_v_left_on, __pyx_v_right_on, __pyx_v_left_suffix, __pyx_v_right_suffix);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_2hash_join(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_left_table, PyObject *__pyx_v_right_table, PyObject *__pyx_v_on, PyObject *__pyx_v_how, PyObject *__pyx_v_left_on, PyObject *__pyx_v_right_on, PyObject *__pyx_v_left_suffix, PyObject *__pyx_v_right_suffix) {
  std::shared_ptr&lt; arrow::Table&gt;  __pyx_v_c_left;
  std::shared_ptr&lt; arrow::Table&gt;  __pyx_v_c_right;
  std::shared_ptr&lt; arrow::Table&gt;  __pyx_v_c_result;
  std::vector&lt;std::string&gt;  __pyx_v_cpp_on_keys;
  std::vector&lt;std::string&gt;  __pyx_v_cpp_left_keys;
  std::vector&lt;std::string&gt;  __pyx_v_cpp_right_keys;
  marble::Status __pyx_v_status;
  enum marble::JoinType __pyx_v_join_type;
  PyObject *__pyx_v_col = NULL;
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_on);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_left_on);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_right_on);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.hash_join", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_col);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_on);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_left_on);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_right_on);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_3hash_join, 0, __pyx_mstate_global-&gt;__pyx_n_u_hash_join, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[43]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 852, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_tuple[4]);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_hash_join, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_mstate_global-&gt;__pyx_tuple[4] = <span class='py_c_api'>PyTuple_Pack</span>(5, ((PyObject*)__pyx_mstate_global-&gt;__pyx_n_u_inner), Py_None, Py_None, ((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u__4), ((PyObject*)__pyx_mstate_global-&gt;__pyx_n_u_right_2)); if (unlikely(!__pyx_mstate_global-&gt;__pyx_tuple[4])) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[4]);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[4]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0853</span>:               <span class="n">left_suffix</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">right_suffix</span><span class="o">=</span><span class="s">&#39;_right&#39;</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0854</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0855</span>: <span class="sd">    Perform hash join between two Arrow tables.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0856</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0857</span>: <span class="sd">    This uses Arrow Acero&#39;s HashJoinNode for efficient SIMD-optimized joining.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0858</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0859</span>: <span class="sd">    Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0860</span>: <span class="sd">        left_table: PyArrow Table (left side of join)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0861</span>: <span class="sd">        right_table: PyArrow Table (right side of join)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0862</span>: <span class="sd">        on: str or list of str - join key column(s) when columns have the same name</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0863</span>: <span class="sd">        how: Join type - &#39;inner&#39;, &#39;left&#39;, &#39;right&#39;, &#39;outer&#39;/&#39;full&#39;, &#39;cross&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0864</span>: <span class="sd">        left_on: str or list of str - left key columns (use when names differ)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0865</span>: <span class="sd">        right_on: str or list of str - right key columns (use when names differ)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0866</span>: <span class="sd">        left_suffix: Suffix for left columns in case of name collision (default: &#39;&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0867</span>: <span class="sd">        right_suffix: Suffix for right columns in case of name collision (default: &#39;_right&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0868</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0869</span>: <span class="sd">    Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0870</span>: <span class="sd">        PyArrow Table with joined result</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0871</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0872</span>: <span class="sd">    Example:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0873</span>: <span class="sd">        # Simple join on same column name</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0874</span>: <span class="sd">        result = marbledb.hash_join(employees, departments, on=&#39;department_id&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0875</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0876</span>: <span class="sd">        # Join with different column names</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0877</span>: <span class="sd">        result = marbledb.hash_join(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0878</span>: <span class="sd">            orders, customers,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0879</span>: <span class="sd">            left_on=&#39;customer_id&#39;,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0880</span>: <span class="sd">            right_on=&#39;id&#39;,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0881</span>: <span class="sd">            how=&#39;left&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0882</span>: <span class="sd">        )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0883</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0884</span>: <span class="sd">        # Multiple key columns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0885</span>: <span class="sd">        result = marbledb.hash_join(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0886</span>: <span class="sd">            table1, table2,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0887</span>: <span class="sd">            on=[&#39;year&#39;, &#39;month&#39;, &#39;category&#39;]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0888</span>: <span class="sd">        )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0889</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0890</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">CTable</span>] <span class="nf">c_left</span><span class="w"> </span><span class="o">=</span> <span class="n">pyarrow_unwrap_table</span><span class="p">(</span><span class="n">left_table</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_f_7pyarrow_3lib_pyarrow_unwrap_table(__pyx_v_left_table);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 890, __pyx_L1_error)</span>
  __pyx_v_c_left = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0891</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">CTable</span>] <span class="nf">c_right</span><span class="w"> </span><span class="o">=</span> <span class="n">pyarrow_unwrap_table</span><span class="p">(</span><span class="n">right_table</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_f_7pyarrow_3lib_pyarrow_unwrap_table(__pyx_v_right_table);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  __pyx_v_c_right = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0892</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">CTable</span>] <span class="nf">c_result</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0893</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">vector</span>[<span class="kt">string</span>] <span class="nf">cpp_on_keys</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0894</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">vector</span>[<span class="kt">string</span>] <span class="nf">cpp_left_keys</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0895</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">vector</span>[<span class="kt">string</span>] <span class="nf">cpp_right_keys</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0896</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0897</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">JoinType</span> <span class="nf">join_type</span><span class="w"> </span><span class="o">=</span> <span class="n">_map_join_type</span><span class="p">(</span><span class="n">how</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>  if (!(likely(<span class='py_c_api'>PyUnicode_CheckExact</span>(__pyx_v_how))||((__pyx_v_how) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("str", __pyx_v_how))) <span class='error_goto'>__PYX_ERR(0, 897, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_f_8marbledb__map_join_type(((PyObject*)__pyx_v_how));<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 897, __pyx_L1_error)</span>
  __pyx_v_join_type = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0898</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0899</span>:     <span class="c"># Handle different key specifications</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0900</span>:     <span class="k">if</span> <span class="n">left_on</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">right_on</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = (__pyx_v_left_on != Py_None);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_4 = (__pyx_v_right_on != Py_None);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_3) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0901</span>:         <span class="c"># Different column names in each table</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0902</span>:         <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">left_on</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>    __pyx_t_3 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_left_on); 
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0903</span>:             <span class="n">left_on</span> <span class="o">=</span> <span class="p">[</span><span class="n">left_on</span><span class="p">]</span></pre>
<pre class='cython code score-9 '>      __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 903, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_left_on);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_left_on);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_left_on) != (0)) <span class='error_goto'>__PYX_ERR(0, 903, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_left_on, __pyx_t_5);
      __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0904</span>:         <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right_on</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>    __pyx_t_3 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_right_on); 
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0905</span>:             <span class="n">right_on</span> <span class="o">=</span> <span class="p">[</span><span class="n">right_on</span><span class="p">]</span></pre>
<pre class='cython code score-9 '>      __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 905, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_right_on);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_right_on);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_right_on) != (0)) <span class='error_goto'>__PYX_ERR(0, 905, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_right_on, __pyx_t_5);
      __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0906</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0907</span>:         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">left_on</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">right_on</span><span class="p">):</span></pre>
<pre class='cython code score-10 '>    __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_left_on);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 907, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_right_on);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 907, __pyx_L1_error)</span>
    __pyx_t_3 = (__pyx_t_6 != __pyx_t_7);
    if (unlikely(__pyx_t_3)) {
/* … */
    }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0908</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;left_on and right_on must have the same length&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>      __pyx_t_8 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_builtin_ValueError);
      __pyx_t_9 = __pyx_builtin_ValueError; 
      __pyx_t_10 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_mstate_global-&gt;__pyx_kp_u_left_on_and_right_on_must_have_t};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (__pyx_t_10*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 908, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      }
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='error_goto'>__PYX_ERR(0, 908, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0909</span>: </pre>
<pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0910</span>:         <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">left_on</span><span class="p">:</span></pre>
<pre class='cython code score-48 '>    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_left_on)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_left_on)) {
      __pyx_t_5 = __pyx_v_left_on; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      __pyx_t_7 = 0;
      __pyx_t_11 = NULL;
    } else {
      __pyx_t_7 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_left_on);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_11 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_11)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_5);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_7 &gt;= __pyx_temp) break;
          }
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_5, __pyx_t_7);
          ++__pyx_t_7;
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_5);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_7 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_NewRef</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_7));
          #else
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_5, __pyx_t_7);
          #endif
          ++__pyx_t_7;
        }
        if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
      } else {
        __pyx_t_9 = __pyx_t_11(__pyx_t_5);
        if (unlikely(!__pyx_t_9)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (unlikely(!<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
            <span class='py_c_api'>PyErr_Clear</span>();
          }
          break;
        }
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col, __pyx_t_9);
      __pyx_t_9 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0911</span>:             <span class="n">cpp_left_keys</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span></pre>
<pre class='cython code score-5 '>      __pyx_t_8 = __pyx_v_col;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      __pyx_t_10 = 0;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_mstate_global-&gt;__pyx_kp_u_utf_8};
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_encode, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 911, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      }
      __pyx_t_12 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_9);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 911, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      try {
        __pyx_v_cpp_left_keys.push_back(__pyx_t_12);
      } catch(...) {
        __Pyx_CppExn2PyErr();
        <span class='error_goto'>__PYX_ERR(0, 911, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0912</span>:         <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">right_on</span><span class="p">:</span></pre>
<pre class='cython code score-48 '>    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_right_on)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_right_on)) {
      __pyx_t_5 = __pyx_v_right_on; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      __pyx_t_7 = 0;
      __pyx_t_11 = NULL;
    } else {
      __pyx_t_7 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_right_on);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 912, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_11 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 912, __pyx_L1_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_11)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_5);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 912, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_7 &gt;= __pyx_temp) break;
          }
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_5, __pyx_t_7);
          ++__pyx_t_7;
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_5);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 912, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_7 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_NewRef</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_7));
          #else
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_5, __pyx_t_7);
          #endif
          ++__pyx_t_7;
        }
        if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 912, __pyx_L1_error)</span>
      } else {
        __pyx_t_9 = __pyx_t_11(__pyx_t_5);
        if (unlikely(!__pyx_t_9)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (unlikely(!<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='error_goto'>__PYX_ERR(0, 912, __pyx_L1_error)</span>
            <span class='py_c_api'>PyErr_Clear</span>();
          }
          break;
        }
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col, __pyx_t_9);
      __pyx_t_9 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0913</span>:             <span class="n">cpp_right_keys</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span></pre>
<pre class='cython code score-5 '>      __pyx_t_8 = __pyx_v_col;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      __pyx_t_10 = 0;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_mstate_global-&gt;__pyx_kp_u_utf_8};
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_encode, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 913, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      }
      __pyx_t_12 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_9);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 913, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      try {
        __pyx_v_cpp_right_keys.push_back(__pyx_t_12);
      } catch(...) {
        __Pyx_CppExn2PyErr();
        <span class='error_goto'>__PYX_ERR(0, 913, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0914</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0915</span>:         <span class="n">status</span> <span class="o">=</span> <span class="n">CppHashJoin</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>    __pyx_v_status = marble::HashJoin(__pyx_v_c_left, __pyx_v_c_right, __pyx_v_cpp_left_keys, __pyx_v_cpp_right_keys, __pyx_v_join_type, __pyx_t_12, __pyx_t_13, (&amp;__pyx_v_c_result));
</pre><pre class="cython line score-0">&#xA0;<span class="">0916</span>:             <span class="n">c_left</span><span class="p">,</span> <span class="n">c_right</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0917</span>:             <span class="n">cpp_left_keys</span><span class="p">,</span> <span class="n">cpp_right_keys</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0918</span>:             <span class="n">join_type</span><span class="p">,</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0919</span>:             <span class="n">left_suffix</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">),</span></pre>
<pre class='cython code score-5 '>    __pyx_t_9 = __pyx_v_left_suffix;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
    __pyx_t_10 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_mstate_global-&gt;__pyx_kp_u_utf_8};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_encode, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 919, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    }
    __pyx_t_12 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_5);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 919, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0920</span>:             <span class="n">right_suffix</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">),</span></pre>
<pre class='cython code score-5 '>    __pyx_t_9 = __pyx_v_right_suffix;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
    __pyx_t_10 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_mstate_global-&gt;__pyx_kp_u_utf_8};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_encode, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 920, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    }
    __pyx_t_13 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_5);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 920, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0921</span>:             <span class="o">&amp;</span><span class="n">c_result</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0922</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0923</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0924</span>:         <span class="c"># Same column names in both tables</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0925</span>:         <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_3 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_on); 
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0926</span>:             <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="n">on</span><span class="p">]</span></pre>
<pre class='cython code score-9 '>      __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 926, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_on);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_on);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_on) != (0)) <span class='error_goto'>__PYX_ERR(0, 926, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_on, __pyx_t_5);
      __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0927</span>: </pre>
<pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0928</span>:         <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">on</span><span class="p">:</span></pre>
<pre class='cython code score-48 '>    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_on)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_on)) {
      __pyx_t_5 = __pyx_v_on; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      __pyx_t_7 = 0;
      __pyx_t_11 = NULL;
    } else {
      __pyx_t_7 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_on);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 928, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_11 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 928, __pyx_L1_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_11)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_5);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 928, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_7 &gt;= __pyx_temp) break;
          }
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_5, __pyx_t_7);
          ++__pyx_t_7;
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_5);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 928, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_7 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_NewRef</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_7));
          #else
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_5, __pyx_t_7);
          #endif
          ++__pyx_t_7;
        }
        if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 928, __pyx_L1_error)</span>
      } else {
        __pyx_t_9 = __pyx_t_11(__pyx_t_5);
        if (unlikely(!__pyx_t_9)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (unlikely(!<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='error_goto'>__PYX_ERR(0, 928, __pyx_L1_error)</span>
            <span class='py_c_api'>PyErr_Clear</span>();
          }
          break;
        }
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col, __pyx_t_9);
      __pyx_t_9 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0929</span>:             <span class="n">cpp_on_keys</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span></pre>
<pre class='cython code score-5 '>      __pyx_t_8 = __pyx_v_col;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      __pyx_t_10 = 0;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_mstate_global-&gt;__pyx_kp_u_utf_8};
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_encode, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 929, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      }
      __pyx_t_13 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_9);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 929, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      try {
        __pyx_v_cpp_on_keys.push_back(__pyx_t_13);
      } catch(...) {
        __Pyx_CppExn2PyErr();
        <span class='error_goto'>__PYX_ERR(0, 929, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0930</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0931</span>:         <span class="n">status</span> <span class="o">=</span> <span class="n">CppHashJoin</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>    __pyx_v_status = marble::HashJoin(__pyx_v_c_left, __pyx_v_c_right, __pyx_v_cpp_on_keys, __pyx_v_join_type, (&amp;__pyx_v_c_result));
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0932</span>:             <span class="n">c_left</span><span class="p">,</span> <span class="n">c_right</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0933</span>:             <span class="n">cpp_on_keys</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0934</span>:             <span class="n">join_type</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0935</span>:             <span class="o">&amp;</span><span class="n">c_result</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0936</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0937</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0938</span>:     <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0939</span>:         <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Hash join failed: {status.ToString().decode(&#39;utf-8&#39;)}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>    __pyx_t_9 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 939, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_14 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 939, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_Hash_join_failed, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 939, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_10 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      assert(__pyx_t_9);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, __pyx__function);
      __pyx_t_10 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_15};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (__pyx_t_10*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 939, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>__PYX_ERR(0, 939, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0940</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0941</span>:     <span class="k">return</span> <span class="n">pyarrow_wrap_table</span><span class="p">(</span><span class="n">c_result</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_5 = __pyx_f_7pyarrow_3lib_pyarrow_wrap_table(__pyx_v_c_result);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 941, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0942</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0943</span>: </pre>
<pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0944</span>: <span class="k">def</span><span class="w"> </span><span class="nf">asof_join</span><span class="p">(</span><span class="n">left_table</span><span class="p">,</span> <span class="n">right_table</span><span class="p">,</span> <span class="n">on_time</span><span class="p">,</span> <span class="k">by</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span></pre>
<pre class='cython code score-74 '>/* Python wrapper */
static PyObject *__pyx_pw_8marbledb_5asof_join(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8marbledb_4asof_join, "asof_join(left_table, right_table, on_time, by=None, tolerance=0, left_suffix='', right_suffix='_right')\n\nPerform ASOF join between two Arrow tables on any time column.\n\nASOF join matches each row in the left table with the closest row in the\nright table based on a time column. This is useful for:\n- Joining trades with quotes (find last quote before each trade)\n- Event correlation with sensor data\n- Point-in-time lookups\n\nIMPORTANT: Both tables must be sorted by the time column before calling.\n\nArgs:\n    left_table: PyArrow Table (left side, typically the \"event\" table)\n    right_table: PyArrow Table (right side, typically the \"reference\" table)\n    on_time: str - name of the time column (must exist in both tables)\n    by: str or list of str - grouping columns for per-group matching (e.g., symbol)\n    tolerance: int - time tolerance for matching\n        - Negative: match only past values (backward, e.g., -1000 = look back 1000 units)\n        - Positive: match only future values (forward)\n        - Zero: exact match only\n    left_suffix: Suffix for left columns in case of collision (default: '')\n    right_suffix: Suffix for right columns in case of collision (default: '_right')\n\nReturns:\n    PyArrow Table with joined result\n\nExample:\n    # Join trades with quotes (backward lookup)\n    trades = pa.table({\n        'timestamp': [1000, 2000, 3000, 4000],\n        'trade_price': [150.0, 151.5, 152.0, 153.0],\n        'quantity': [100, 200, 150, 175]\n    })\n    quotes = pa.table({\n        'timestamp': [900, 1500, 2500, 3500],\n        'bid': [149.9, 150.9, 151.9, 152.9],\n        'ask': [150.1, 151.1, 152.1, 153.1]\n    })\n\n    # Find last quote before each trade\n    result = marbledb.asof_join(\n        trades, quotes,\n        on_time='timestamp',\n        tolerance=-1000  # Look back up to 1000 time units\n    )\n\n    # With grouping by symbol\n    result = marbledb.asof_join(\n        trades, quotes,\n        on_time='timestamp'"",\n        by='symbol',\n        tolerance=-1000\n    )");
static PyMethodDef __pyx_mdef_8marbledb_5asof_join = {"asof_join", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8marbledb_5asof_join, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8marbledb_4asof_join};
static PyObject *__pyx_pw_8marbledb_5asof_join(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_left_table = 0;
  PyObject *__pyx_v_right_table = 0;
  PyObject *__pyx_v_on_time = 0;
  PyObject *__pyx_v_by = 0;
  PyObject *__pyx_v_tolerance = 0;
  PyObject *__pyx_v_left_suffix = 0;
  PyObject *__pyx_v_right_suffix = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("asof_join (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_left_table,&amp;__pyx_mstate_global-&gt;__pyx_n_u_right_table,&amp;__pyx_mstate_global-&gt;__pyx_n_u_on_time,&amp;__pyx_mstate_global-&gt;__pyx_n_u_by,&amp;__pyx_mstate_global-&gt;__pyx_n_u_tolerance,&amp;__pyx_mstate_global-&gt;__pyx_n_u_left_suffix,&amp;__pyx_mstate_global-&gt;__pyx_n_u_right_suffix,0};
  PyObject* values[7] = {0,0,0,0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  7:
        values[6] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 6);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[6])) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  6:
        values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "asof_join", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
      if (!values[3]) values[3] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)Py_None));
      if (!values[4]) values[4] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_int_0)));
      if (!values[5]) values[5] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u__4)));
      if (!values[6]) values[6] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_n_u_right_2)));
      for (Py_ssize_t i = __pyx_nargs; i &lt; 3; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("asof_join", 0, 3, 7, i); <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span> }
      }
    } else {
      switch (__pyx_nargs) {
        case  7:
        values[6] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 6);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[6])) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  6:
        values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[3]) values[3] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)Py_None));
      if (!values[4]) values[4] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_int_0)));
      if (!values[5]) values[5] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u__4)));
      if (!values[6]) values[6] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_n_u_right_2)));
    }
    __pyx_v_left_table = values[0];
    __pyx_v_right_table = values[1];
    __pyx_v_on_time = values[2];
    __pyx_v_by = values[3];
    __pyx_v_tolerance = values[4];
    __pyx_v_left_suffix = values[5];
    __pyx_v_right_suffix = values[6];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("asof_join", 0, 3, 7, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("marbledb.asof_join", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8marbledb_4asof_join(__pyx_self, __pyx_v_left_table, __pyx_v_right_table, __pyx_v_on_time, __pyx_v_by, __pyx_v_tolerance, __pyx_v_left_suffix, __pyx_v_right_suffix);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8marbledb_4asof_join(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_left_table, PyObject *__pyx_v_right_table, PyObject *__pyx_v_on_time, PyObject *__pyx_v_by, PyObject *__pyx_v_tolerance, PyObject *__pyx_v_left_suffix, PyObject *__pyx_v_right_suffix) {
  std::shared_ptr&lt; arrow::Table&gt;  __pyx_v_c_left;
  std::shared_ptr&lt; arrow::Table&gt;  __pyx_v_c_right;
  std::shared_ptr&lt; arrow::Table&gt;  __pyx_v_c_result;
  marble::AsofJoinSpec __pyx_v_spec;
  marble::Status __pyx_v_status;
  PyObject *__pyx_v_col = NULL;
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_by);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8marbledb_5asof_join, 0, __pyx_mstate_global-&gt;__pyx_n_u_asof_join, NULL, __pyx_mstate_global-&gt;__pyx_n_u_marbledb, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[44]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_tuple[5]);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_asof_join, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0945</span>:               <span class="n">left_suffix</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">right_suffix</span><span class="o">=</span><span class="s">&#39;_right&#39;</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0946</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0947</span>: <span class="sd">    Perform ASOF join between two Arrow tables on any time column.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0948</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0949</span>: <span class="sd">    ASOF join matches each row in the left table with the closest row in the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0950</span>: <span class="sd">    right table based on a time column. This is useful for:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0951</span>: <span class="sd">    - Joining trades with quotes (find last quote before each trade)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0952</span>: <span class="sd">    - Event correlation with sensor data</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0953</span>: <span class="sd">    - Point-in-time lookups</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0954</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0955</span>: <span class="sd">    IMPORTANT: Both tables must be sorted by the time column before calling.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0956</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0957</span>: <span class="sd">    Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0958</span>: <span class="sd">        left_table: PyArrow Table (left side, typically the &quot;event&quot; table)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0959</span>: <span class="sd">        right_table: PyArrow Table (right side, typically the &quot;reference&quot; table)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0960</span>: <span class="sd">        on_time: str - name of the time column (must exist in both tables)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0961</span>: <span class="sd">        by: str or list of str - grouping columns for per-group matching (e.g., symbol)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0962</span>: <span class="sd">        tolerance: int - time tolerance for matching</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0963</span>: <span class="sd">            - Negative: match only past values (backward, e.g., -1000 = look back 1000 units)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0964</span>: <span class="sd">            - Positive: match only future values (forward)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0965</span>: <span class="sd">            - Zero: exact match only</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0966</span>: <span class="sd">        left_suffix: Suffix for left columns in case of collision (default: &#39;&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0967</span>: <span class="sd">        right_suffix: Suffix for right columns in case of collision (default: &#39;_right&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0968</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0969</span>: <span class="sd">    Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0970</span>: <span class="sd">        PyArrow Table with joined result</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0971</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0972</span>: <span class="sd">    Example:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0973</span>: <span class="sd">        # Join trades with quotes (backward lookup)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0974</span>: <span class="sd">        trades = pa.table({</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0975</span>: <span class="sd">            &#39;timestamp&#39;: [1000, 2000, 3000, 4000],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0976</span>: <span class="sd">            &#39;trade_price&#39;: [150.0, 151.5, 152.0, 153.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0977</span>: <span class="sd">            &#39;quantity&#39;: [100, 200, 150, 175]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0978</span>: <span class="sd">        })</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0979</span>: <span class="sd">        quotes = pa.table({</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0980</span>: <span class="sd">            &#39;timestamp&#39;: [900, 1500, 2500, 3500],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0981</span>: <span class="sd">            &#39;bid&#39;: [149.9, 150.9, 151.9, 152.9],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0982</span>: <span class="sd">            &#39;ask&#39;: [150.1, 151.1, 152.1, 153.1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0983</span>: <span class="sd">        })</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0984</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0985</span>: <span class="sd">        # Find last quote before each trade</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0986</span>: <span class="sd">        result = marbledb.asof_join(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0987</span>: <span class="sd">            trades, quotes,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0988</span>: <span class="sd">            on_time=&#39;timestamp&#39;,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0989</span>: <span class="sd">            tolerance=-1000  # Look back up to 1000 time units</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0990</span>: <span class="sd">        )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0991</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0992</span>: <span class="sd">        # With grouping by symbol</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0993</span>: <span class="sd">        result = marbledb.asof_join(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0994</span>: <span class="sd">            trades, quotes,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0995</span>: <span class="sd">            on_time=&#39;timestamp&#39;,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0996</span>: <span class="sd">            by=&#39;symbol&#39;,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0997</span>: <span class="sd">            tolerance=-1000</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0998</span>: <span class="sd">        )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0999</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1000</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">CTable</span>] <span class="nf">c_left</span><span class="w"> </span><span class="o">=</span> <span class="n">pyarrow_unwrap_table</span><span class="p">(</span><span class="n">left_table</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_f_7pyarrow_3lib_pyarrow_unwrap_table(__pyx_v_left_table);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1000, __pyx_L1_error)</span>
  __pyx_v_c_left = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1001</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">CTable</span>] <span class="nf">c_right</span><span class="w"> </span><span class="o">=</span> <span class="n">pyarrow_unwrap_table</span><span class="p">(</span><span class="n">right_table</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_f_7pyarrow_3lib_pyarrow_unwrap_table(__pyx_v_right_table);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1001, __pyx_L1_error)</span>
  __pyx_v_c_right = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1002</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">shared_ptr</span>[<span class="kt">CTable</span>] <span class="nf">c_result</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1003</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">AsofJoinSpec</span> <span class="nf">spec</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1004</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">Status</span> <span class="nf">status</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1005</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1006</span>: <span class="w">    </span><span class="c"># Set time column</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1007</span>:     <span class="n">spec</span><span class="o">.</span><span class="n">time_column</span> <span class="o">=</span> <span class="n">on_time</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = __pyx_v_on_time;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_4 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_utf_8};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_encode, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1007, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  }
  __pyx_t_5 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_2);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1007, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_spec.time_column = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_5);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1008</span>:     <span class="n">spec</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="n">tolerance</span></pre>
<pre class='cython code score-5 '>  __pyx_t_6 = __Pyx_PyLong_As_int64_t(__pyx_v_tolerance); if (unlikely((__pyx_t_6 == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1008, __pyx_L1_error)</span>
  __pyx_v_spec.tolerance = __pyx_t_6;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1009</span>:     <span class="n">spec</span><span class="o">.</span><span class="n">left_suffix</span> <span class="o">=</span> <span class="n">left_suffix</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = __pyx_v_left_suffix;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_4 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_utf_8};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_encode, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1009, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  }
  __pyx_t_5 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_2);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1009, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_spec.left_suffix = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_5);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1010</span>:     <span class="n">spec</span><span class="o">.</span><span class="n">right_suffix</span> <span class="o">=</span> <span class="n">right_suffix</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = __pyx_v_right_suffix;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_4 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_kp_u_utf_8};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_encode, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1010, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  }
  __pyx_t_5 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_2);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1010, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_spec.right_suffix = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_5);
</pre><pre class="cython line score-0">&#xA0;<span class="">1011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1012</span>:     <span class="c"># Set by columns if provided</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1013</span>:     <span class="k">if</span> <span class="k">by</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = (__pyx_v_by != Py_None);
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1014</span>:         <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="k">by</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>    __pyx_t_7 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_by); 
    if (__pyx_t_7) {
/* … */
    }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1015</span>:             <span class="k">by</span> <span class="o">=</span> <span class="p">[</span><span class="k">by</span><span class="p">]</span></pre>
<pre class='cython code score-9 '>      __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1015, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_by);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_by);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_by) != (0)) <span class='error_goto'>__PYX_ERR(0, 1015, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_by, __pyx_t_2);
      __pyx_t_2 = 0;
</pre><pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1016</span>:         <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="k">by</span><span class="p">:</span></pre>
<pre class='cython code score-48 '>    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_by)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_by)) {
      __pyx_t_2 = __pyx_v_by; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_by);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1016, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_9 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1016, __pyx_L1_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1016, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_8 &gt;= __pyx_temp) break;
          }
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_2, __pyx_t_8);
          ++__pyx_t_8;
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_2);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1016, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_8 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_NewRef</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_8));
          #else
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_8);
          #endif
          ++__pyx_t_8;
        }
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1016, __pyx_L1_error)</span>
      } else {
        __pyx_t_3 = __pyx_t_9(__pyx_t_2);
        if (unlikely(!__pyx_t_3)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (unlikely(!<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='error_goto'>__PYX_ERR(0, 1016, __pyx_L1_error)</span>
            <span class='py_c_api'>PyErr_Clear</span>();
          }
          break;
        }
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col, __pyx_t_3);
      __pyx_t_3 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1017</span>:             <span class="n">spec</span><span class="o">.</span><span class="n">by_columns</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span></pre>
<pre class='cython code score-5 '>      __pyx_t_10 = __pyx_v_col;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      __pyx_t_4 = 0;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_mstate_global-&gt;__pyx_kp_u_utf_8};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_encode, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1017, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      }
      __pyx_t_5 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_3);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1017, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      try {
        __pyx_v_spec.by_columns.push_back(__pyx_t_5);
      } catch(...) {
        __Pyx_CppExn2PyErr();
        <span class='error_goto'>__PYX_ERR(0, 1017, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1018</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1019</span>:     <span class="n">status</span> <span class="o">=</span> <span class="n">CppAsofJoin</span><span class="p">(</span><span class="n">c_left</span><span class="p">,</span> <span class="n">c_right</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">c_result</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_status = marble::AsofJoin(__pyx_v_c_left, __pyx_v_c_right, __pyx_v_spec, (&amp;__pyx_v_c_result));
</pre><pre class="cython line score-0">&#xA0;<span class="">1020</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1021</span>:     <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = (!(__pyx_v_status.ok() != 0));
  if (unlikely(__pyx_t_7)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1022</span>:         <span class="k">raise</span> <span class="n">MarbleDBError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;ASOF join failed: {status.ToString().decode(&#39;utf-8&#39;)}&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_mstate_global-&gt;__pyx_n_u_MarbleDBError);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1022, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_11 = __Pyx_decode_cpp_string(__pyx_v_status.ToString(), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1022, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_ASOF_join_failed, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1022, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_4 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, __pyx__function);
      __pyx_t_4 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_12};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1022, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1022, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1023</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1024</span>:     <span class="k">return</span> <span class="n">pyarrow_wrap_table</span><span class="p">(</span><span class="n">c_result</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = __pyx_f_7pyarrow_3lib_pyarrow_wrap_table(__pyx_v_c_result);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1024, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre></div></body></html>
